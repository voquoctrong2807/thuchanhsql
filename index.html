<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Master - H∆∞·ªõng D·∫´n Th·ª±c H√†nh CSDL (Final)</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Markdown Parser -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- AlaSQL (SQL Engine in JS) -->
    <script src="https://cdn.jsdelivr.net/npm/alasql@1.7.3/dist/alasql.min.js"></script>
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body class="h-screen flex overflow-hidden text-slate-800 bg-slate-50">

    <!-- SIDEBAR -->
    <aside id="sidebar" class="w-72 bg-white border-r border-slate-200 flex-col h-full hidden md:flex z-40 transition-all duration-300 shadow-xl md:shadow-none shrink-0">
        <!-- User Profile Header -->
        <div class="p-4 border-b border-slate-100 bg-slate-50">
            <h1 class="text-xl font-bold text-indigo-700 flex items-center gap-2 mb-4">
                <span class="material-symbols-outlined filled">database</span> SQL Master
            </h1>
            
            <!-- Auth Status -->
            <div id="auth-section" class="mb-2">
                <div id="logged-out-view" class="flex gap-2">
                    <button onclick="openAuthModal('login')" class="flex-1 bg-white border border-slate-300 text-slate-700 py-1.5 rounded text-xs font-bold hover:bg-slate-100 transition">ƒêƒÉng nh·∫≠p</button>
                    <button onclick="openAuthModal('register')" class="flex-1 bg-indigo-600 text-white py-1.5 rounded text-xs font-bold hover:bg-indigo-700 transition">ƒêƒÉng k√Ω</button>
                </div>
                <div id="logged-in-view" class="hidden">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm font-bold text-slate-700 truncate" id="username-display">User</span>
                        <button onclick="logout()" class="text-xs text-red-500 hover:text-red-700 hover:underline">Tho√°t</button>
                    </div>
                    <!-- Gamification Bar -->
                    <div class="bg-white p-2 rounded border border-slate-200 shadow-sm">
                        <div class="flex justify-between text-[10px] font-bold text-slate-500 mb-1">
                            <span>LVL <span id="user-lvl">1</span></span>
                            <span class="text-indigo-600"><span id="user-xp">0</span> XP</span>
                        </div>
                        <div class="w-full bg-slate-100 rounded-full h-1.5">
                            <div id="xp-bar" class="bg-indigo-500 h-1.5 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 overflow-y-auto p-4 space-y-1 custom-scroll">
            <div class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2 mt-1 pl-2">1. Ng√¥n ng·ªØ SQL</div>
            <button onclick="scrollToSection('ddl')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-md text-sm transition-colors text-indigo-700 font-bold bg-indigo-50 border-r-4 border-indigo-600">
                <span class="material-symbols-outlined text-lg">table_view</span> 1.1 ƒê·ªãnh nghƒ©a (DDL)
            </button>
            <button onclick="scrollToSection('dml')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-md text-sm transition-colors text-slate-600 hover:bg-slate-50">
                <span class="material-symbols-outlined text-lg">query_stats</span> 1.2 Thao t√°c (DML)
            </button>
            <button onclick="scrollToSection('triggers')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-md text-sm transition-colors text-slate-600 hover:bg-slate-50">
                <span class="material-symbols-outlined text-lg">bolt</span> 1.3 Trigger
            </button>
            
            <div class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2 mt-6 pl-2">2. L√Ω thuy·∫øt thi·∫øt k·∫ø</div>
            <button onclick="scrollToSection('keys')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-md text-sm transition-colors text-slate-600 hover:bg-slate-50">
                <span class="material-symbols-outlined text-lg">key</span> 2.1 T√¨m Kho√° (Bao ƒë√≥ng)
            </button>
            <button onclick="scrollToSection('normalization')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-md text-sm transition-colors text-slate-600 hover:bg-slate-50">
                <span class="material-symbols-outlined text-lg">checklist</span> 2.2 D·∫°ng chu·∫©n (NF)
            </button>
            <button onclick="scrollToSection('decomposition')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-md text-sm transition-colors text-slate-600 hover:bg-slate-50">
                <span class="material-symbols-outlined text-lg">call_split</span> 2.3 Ph√¢n r√£ (PTT)
            </button>

            <div class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2 mt-6 pl-2">3. H·ªçc T·∫≠p & Luy·ªán Thi</div>
            <button onclick="scrollToSection('exercises-section')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-md text-sm transition-colors text-slate-600 hover:bg-slate-50">
                <span class="material-symbols-outlined text-lg">fitness_center</span> 3.1 B√†i T·∫≠p & Th·ª≠ Th√°ch
            </button>

            <div class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2 mt-6 pl-2">4. Th·ª±c H√†nh</div>
            <button onclick="scrollToSection('demo')" class="nav-item w-full flex items-center gap-3 px-4 py-2.5 rounded-md text-sm transition-colors text-slate-600 hover:bg-slate-50">
                <span class="material-symbols-outlined text-lg">terminal</span> 4.1 SQL Live Demo
            </button>
        </nav>

        <div class="p-4 border-t border-slate-100 bg-slate-50 space-y-2 no-print">
             <!-- RESTORED PRINT BUTTON -->
             <button onclick="window.print()" class="w-full flex items-center justify-center gap-2 bg-indigo-600 text-white text-xs font-bold py-2.5 px-4 rounded hover:bg-indigo-700 transition shadow-md mb-2">
                <span class="material-symbols-outlined text-sm">picture_as_pdf</span> Xu·∫•t PDF
            </button>
            <button onclick="openSettings()" class="w-full flex items-center justify-center gap-2 bg-white border border-slate-300 text-slate-600 text-xs font-bold py-2 px-4 rounded hover:bg-slate-100 transition">
                <span class="material-symbols-outlined text-sm">settings</span> C√†i ƒë·∫∑t
            </button>
        </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main id="main-content" class="flex-1 h-full overflow-y-auto p-4 md:p-6 relative w-full scroll-smooth">
        
        <!-- Mobile Header -->
        <div class="md:hidden flex items-center justify-between mb-4 no-print">
            <h1 class="text-lg font-bold text-indigo-700 flex items-center gap-2">SQL Master</h1>
            <button class="p-2 bg-white rounded shadow text-slate-600" onclick="document.getElementById('sidebar').classList.toggle('hidden'); document.getElementById('sidebar').classList.toggle('absolute'); document.getElementById('sidebar').classList.toggle('w-full');">
                <span class="material-symbols-outlined">menu</span>
            </button>
        </div>

        <!-- 1.1 DDL SECTION -->
        <section id="ddl" class="content-section max-w-5xl mx-auto mb-16 animate-fade-in">
            <div class="flex items-center gap-3 mb-6 border-b border-slate-200 pb-4">
                <div class="bg-indigo-100 text-indigo-700 p-2 rounded-lg"><span class="material-symbols-outlined">table_view</span></div>
                <div>
                    <h2 class="text-2xl font-bold text-slate-800">1.1 ƒê·ªãnh nghƒ©a D·ªØ li·ªáu (DDL)</h2>
                    <p class="text-slate-500 text-sm">C√∫ ph√°p t·∫°o b·∫£ng, thi·∫øt l·∫≠p r√†ng bu·ªôc to√†n v·∫πn v√† ch·ªânh s·ª≠a c·∫•u tr√∫c.</p>
                </div>
            </div>

            <!-- Sub-Tabs -->
            <div class="bg-slate-200/50 p-1 rounded-lg inline-flex mb-6 no-print tab-buttons-container">
                <button onclick="switchSubTab('ddl', 'create')" class="tab-btn-ddl active px-4 py-2 rounded text-sm font-medium text-slate-600 transition" data-target="create">1. T·∫°o B·∫£ng</button>
                <button onclick="switchSubTab('ddl', 'constraints')" class="tab-btn-ddl px-4 py-2 rounded text-sm font-medium text-slate-600 transition" data-target="constraints">2. C√°c R√†ng Bu·ªôc</button>
                <button onclick="switchSubTab('ddl', 'alter')" class="tab-btn-ddl px-4 py-2 rounded text-sm font-medium text-slate-600 transition" data-target="alter">3. Th√™m/X√≥a C·ªôt</button>
            </div>

            <!-- 1.1.1 Create Table -->
            <div id="ddl-create" class="ddl-content block">
                <div class="grid lg:grid-cols-2 gap-8 items-start">
                    <!-- Explain -->
                    <div class="space-y-4">
                        <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg">
                            <h4 class="font-bold text-blue-800 text-sm mb-2">üí° Gi·∫£i th√≠ch chi ti·∫øt</h4>
                            <p class="text-sm text-blue-800 mb-2">ƒê·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu, ta c·∫ßn t·∫°o c√°c "ngƒÉn ch·ª©a" g·ªçi l√† B·∫£ng (Table). V√≠ d·ª• d∆∞·ªõi ƒë√¢y t·∫°o 2 b·∫£ng c√≥ m·ªëi quan h·ªá:</p>
                            <ul class="list-disc list-inside text-sm text-blue-700 space-y-1 ml-1">
                                <li><b>B·∫£ng Lop:</b> Danh m·ª•c l·ªõp h·ªçc. <code>MaLop</code> l√† ƒë·ªãnh danh duy nh·∫•t.</li>
                                <li><b>B·∫£ng SinhVien:</b> Ch·ª©a th√¥ng tin SV. M·ªói SV ph·∫£i thu·ªôc v·ªÅ 1 L·ªõp n√†o ƒë√≥ (li√™n k·∫øt qua <code>MaLop</code>).</li>
                            </ul>
                        </div>
                        <!-- Visual -->
                        <div class="flex items-center justify-center gap-6 p-4 bg-white rounded-lg border border-slate-200">
                            <div class="table-visual">
                                <div class="table-header bg-slate-100">Lop</div>
                                <div class="table-row font-bold"><span class="pk-badge">PK</span> MaLop</div>
                                <div class="table-row">TenLop</div>
                            </div>
                            <div class="h-[2px] w-8 bg-slate-300 relative">
                                <div class="absolute -top-3 left-1/2 -translate-x-1/2 text-[10px] text-slate-500 font-bold">1-N</div>
                            </div>
                            <div class="table-visual">
                                <div class="table-header bg-slate-100">SinhVien</div>
                                <div class="table-row font-bold"><span class="pk-badge">PK</span> MaSV</div>
                                <div class="table-row">HoTen</div>
                                <div class="table-row text-indigo-600 bg-indigo-50 font-medium text-[10px]">FK: MaLop</div>
                            </div>
                        </div>
                    </div>

                    <!-- Code -->
                    <div class="space-y-4">
                        <div class="code-block p-4 rounded-lg overflow-x-auto shadow-sm" id="code-create-table">

<span class="sql-kw">CREATE TABLE</span> Lop (
    MaLop <span class="sql-kw">CHAR</span>(5) <span class="sql-kw">PRIMARY KEY</span>,  <span class="sql-com">-- Kh√≥a ch√≠nh: Kh√¥ng tr√πng, kh√¥ng NULL</span>
    TenLop <span class="sql-kw">NVARCHAR</span>(50) <span class="sql-kw">NOT NULL</span> <span class="sql-com">-- Kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng t√™n l·ªõp</span>
);

<span class="sql-kw">CREATE TABLE</span> SinhVien (
    MaSV <span class="sql-kw">CHAR</span>(10) <span class="sql-kw">PRIMARY KEY</span>,
    HoTen <span class="sql-kw">NVARCHAR</span>(100),
    <span class="sql-com">-- MaLop ·ªü ƒë√¢y l√† Kh√≥a Ngo·∫°i tham chi·∫øu sang b·∫£ng Lop</span>
    MaLop <span class="sql-kw">CHAR</span>(5) <span class="sql-kw">REFERENCES</span> Lop(MaLop)
);

                        </div>
                        <button onclick="explainCode('code-create-table', 'expl-create', 'Gi·∫£i th√≠ch k·ªπ v·ªÅ ki·ªÉu d·ªØ li·ªáu CHAR vs NVARCHAR v√† t√°c d·ª•ng c·ªßa REFERENCES.')" class="ai-btn text-xs bg-indigo-600 text-white px-4 py-2 rounded shadow-sm hover:bg-indigo-700 transition no-print w-fit flex items-center gap-2">
                            <span class="material-symbols-outlined text-sm">smart_toy</span> AI: Ph√¢n t√≠ch Code n√†y
                        </button>
                        <div id="expl-create" class="ai-explanation-box"></div>
                    </div>
                </div>
            </div>

            <!-- 1.1.2 Constraints -->
            <div id="ddl-constraints" class="ddl-content hidden">
                <p class="text-sm text-slate-600 mb-4 bg-white p-3 rounded border border-slate-200">
                    <b>R√†ng bu·ªôc to√†n v·∫πn (Constraints)</b> l√† c√°c quy t·∫Øc √°p ƒë·∫∑t l√™n c·ªôt d·ªØ li·ªáu ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh ch√≠nh x√°c v√† nh·∫•t qu√°n. D∆∞·ªõi ƒë√¢y l√† 5 lo·∫°i quan tr·ªçng nh·∫•t:
                </p>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="space-y-3">
                        <div class="p-3 bg-white rounded-lg border border-slate-200 shadow-sm hover:border-indigo-300 transition">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-xs font-bold bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded">PK - Primary Key</span>
                            </div>
                            <p class="text-xs text-slate-600">ƒê·ªãnh danh duy nh·∫•t cho m·ªói d√≤ng (v√≠ d·ª•: S·ªë CMND). M·ªôt b·∫£ng ch·ªâ c√≥ 1 PK.</p>
                        </div>
                        <div class="p-3 bg-white rounded-lg border border-slate-200 shadow-sm hover:border-indigo-300 transition">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-xs font-bold bg-blue-100 text-blue-800 px-2 py-0.5 rounded">FK - Foreign Key</span>
                            </div>
                            <p class="text-xs text-slate-600">ƒê·∫£m b·∫£o d·ªØ li·ªáu tham chi·∫øu t·ªìn t·∫°i (v√≠ d·ª•: Kh√¥ng th·ªÉ nh·∫≠p ƒëi·ªÉm cho 1 SV kh√¥ng t·ªìn t·∫°i).</p>
                        </div>
                        <div class="p-3 bg-white rounded-lg border border-slate-200 shadow-sm hover:border-indigo-300 transition">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-xs font-bold bg-green-100 text-green-800 px-2 py-0.5 rounded">CHECK</span>
                            </div>
                            <p class="text-xs text-slate-600">Ki·ªÉm tra ƒëi·ªÅu ki·ªán logic. V√≠ d·ª•: <code>Tuoi >= 18</code>, <code>Diem BETWEEN 0 AND 10</code>.</p>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="p-3 bg-white rounded-lg border border-slate-200 shadow-sm hover:border-indigo-300 transition">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-xs font-bold bg-purple-100 text-purple-800 px-2 py-0.5 rounded">UNIQUE</span>
                            </div>
                            <p class="text-xs text-slate-600">Gi√° tr·ªã kh√¥ng ƒë∆∞·ª£c tr√πng nhau gi·ªØa c√°c d√≤ng (nh∆∞ng cho ph√©p NULL). V√≠ d·ª•: Email c√° nh√¢n.</p>
                        </div>
                        <div class="p-3 bg-white rounded-lg border border-slate-200 shadow-sm hover:border-indigo-300 transition">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-xs font-bold bg-gray-100 text-slate-800 px-2 py-0.5 rounded">DEFAULT</span>
                            </div>
                            <p class="text-xs text-slate-600">T·ª± ƒëi·ªÅn gi√° tr·ªã m·∫∑c ƒë·ªãnh n·∫øu ng∆∞·ªùi d√πng b·ªè tr·ªëng. V√≠ d·ª•: Ng√†y t·∫°o = H√¥m nay.</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6">
                    <h4 class="text-sm font-bold text-slate-700 mb-2">V√≠ d·ª• t·ªïng h·ª£p:</h4>
                    <div class="code-block p-4 rounded-lg shadow-sm" id="code-constraints">
<span class="sql-kw">CREATE TABLE</span> NhanVien (
    MaNV <span class="sql-kw">INT PRIMARY KEY</span>,               
    TenNV <span class="sql-kw">NVARCHAR</span>(50) <span class="sql-kw">NOT NULL</span>,    <span class="sql-com">-- B·∫Øt bu·ªôc nh·∫≠p</span>
    Email <span class="sql-kw">VARCHAR</span>(100) <span class="sql-kw">UNIQUE</span>,      <span class="sql-com">-- Kh√¥ng tr√πng email</span>
    NgayVaoLam <span class="sql-kw">DATE DEFAULT</span> <span class="sql-fn">GETDATE</span>(), <span class="sql-com">-- M·∫∑c ƒë·ªãnh l√† h√¥m nay</span>
    Tuoi <span class="sql-kw">INT CHECK</span> (Tuoi >= 18),      <span class="sql-com">-- Ph·∫£i ƒë·ªß 18 tu·ªïi</span>
    MaPhong <span class="sql-kw">INT REFERENCES</span> Phong(Ma)  <span class="sql-com">-- Ph·∫£i thu·ªôc ph√≤ng ban c√≥ th·∫≠t</span>
);
                    </div>
                    <button onclick="explainCode('code-constraints', 'expl-constraints', 'Gi·∫£i th√≠ch chi ti·∫øt t√°c d·ª•ng c·ªßa t·ª´ng d√≤ng code trong b·∫£ng NhanVien.')" class="mt-3 ai-btn text-xs bg-indigo-600 text-white px-4 py-2 rounded shadow-sm hover:bg-indigo-700 transition no-print flex items-center gap-2 w-fit">
                        <span class="material-symbols-outlined text-sm">smart_toy</span> AI: Gi·∫£i th√≠ch v√≠ d·ª• n√†y
                    </button>
                    <div id="expl-constraints" class="ai-explanation-box"></div>
                </div>
            </div>

            <!-- 1.1.3 Alter -->
            <div id="ddl-alter" class="ddl-content hidden">
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6">
                    <p class="text-sm text-yellow-800"><b>L∆∞u √Ω:</b> Vi·ªác s·ª≠a ƒë·ªïi c·∫•u tr√∫c b·∫£ng (ALTER) th∆∞·ªùng √≠t d√πng khi thi·∫øt k·∫ø ban ƒë·∫ßu, nh∆∞ng r·∫•t quan tr·ªçng khi b·∫£o tr√¨ h·ªá th·ªëng th·ª±c t·∫ø (khi y√™u c·∫ßu nghi·ªáp v·ª• thay ƒë·ªïi).</p>
                </div>
                <div class="grid lg:grid-cols-2 gap-8">
                    <!-- Visual -->
                    <div class="bg-white p-6 rounded-xl border border-slate-200 flex flex-col items-center justify-center gap-4 shadow-sm">
                        <div class="text-xs font-bold text-slate-500 uppercase tracking-wide">Minh h·ªça Th√™m C·ªôt</div>
                        <div class="flex items-center gap-4">
                            <div class="table-visual h-20 w-24 opacity-60 flex flex-col justify-center items-center bg-slate-50 border-dashed border-2">
                                <span class="text-[10px]">C·ªôt A</span>
                                <span class="text-[10px]">C·ªôt B</span>
                            </div>
                            <span class="material-symbols-outlined text-green-600">add_circle</span>
                            <div class="table-visual h-24 w-24 border-green-400 flex flex-col">
                                <div class="flex-1 flex flex-col justify-center items-center">
                                    <span class="text-[10px]">C·ªôt A</span>
                                    <span class="text-[10px]">C·ªôt B</span>
                                </div>
                                <div class="bg-green-100 text-green-800 text-[9px] font-bold py-1 text-center">+ Email</div>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div class="bg-white p-4 rounded-lg border border-slate-200">
                            <h4 class="text-sm font-bold text-slate-700 mb-2">1. Th√™m c·ªôt m·ªõi (ADD)</h4>
                            <div class="code-block p-3 rounded text-sm" id="code-add-col"><span class="sql-kw">ALTER TABLE</span> SinhVien <span class="sql-kw">ADD</span> Email <span class="sql-kw">VARCHAR</span>(50);</div>
                        </div>
                        <div class="bg-white p-4 rounded-lg border border-slate-200">
                            <h4 class="text-sm font-bold text-slate-700 mb-2">2. X√≥a c·ªôt (DROP)</h4>
                            <div class="code-block p-3 rounded text-sm" id="code-drop-col"><span class="sql-kw">ALTER TABLE</span> SinhVien <span class="sql-kw">DROP COLUMN</span> Email;</div>
                        </div>
                        <button onclick="explainCode('code-add-col', 'expl-alter', 'Gi·∫£i th√≠ch khi n√†o c·∫ßn d√πng ALTER TABLE v√† r·ªßi ro khi DROP COLUMN.')" class="ai-btn text-xs bg-indigo-600 text-white px-4 py-2 rounded shadow-sm hover:bg-indigo-700 transition no-print flex items-center gap-2 w-fit">
                            <span class="material-symbols-outlined text-sm">smart_toy</span> AI: Gi·∫£i th√≠ch Alter
                        </button>
                        <div id="expl-alter" class="ai-explanation-box"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 1.2 DML SECTION -->
        <section id="dml" class="content-section max-w-5xl mx-auto mb-16 animate-fade-in hidden">
            <div class="flex items-center gap-3 mb-6 border-b border-slate-200 pb-4">
                <div class="bg-indigo-100 text-indigo-700 p-2 rounded-lg"><span class="material-symbols-outlined">query_stats</span></div>
                <div><h2 class="text-2xl font-bold text-slate-800">1.2 Thao t√°c D·ªØ li·ªáu (DML)</h2></div>
            </div>

            <!-- AI TEXT TO SQL -->
            <div class="bg-white p-6 rounded-xl border border-indigo-100 shadow-lg mb-8 no-print ring-1 ring-indigo-50">
                <div class="flex items-center gap-2 mb-3">
                    <span class="material-symbols-outlined text-indigo-600 text-2xl">auto_awesome</span>
                    <div>
                        <h3 class="font-bold text-indigo-900 text-lg">AI Tr·ª£ L√Ω SQL</h3>
                        <p class="text-xs text-slate-500">Nh·∫≠p y√™u c·∫ßu b·∫±ng ti·∫øng Vi·ªát, AI s·∫Ω vi·∫øt c√¢u l·ªánh SQL cho b·∫°n.</p>
                    </div>
                </div>
                <div class="flex gap-4 flex-col md:flex-row">
                    <div class="flex-1">
                        <textarea id="ai-sql-input" class="w-full p-3 border border-slate-300 rounded-lg text-sm h-28 focus:ring-2 focus:ring-indigo-500 outline-none resize-none font-sans" placeholder="V√≠ d·ª•: T√¨m top 5 sinh vi√™n c√≥ ƒëi·ªÉm trung b√¨nh cao nh·∫•t khoa CNTT..."></textarea>
                        <button onclick="generateSQL()" class="mt-2 bg-indigo-600 text-white px-6 py-2.5 rounded-lg text-sm font-bold hover:bg-indigo-700 transition shadow-md w-full md:w-auto flex items-center justify-center gap-2">
                            <span class="material-symbols-outlined text-sm">magic_button</span> T·∫°o Code SQL
                        </button>
                    </div>
                    <div class="flex-1">
                        <div id="ai-sql-output" class="w-full p-4 border border-slate-200 bg-slate-50 rounded-lg text-sm font-mono h-28 overflow-auto text-slate-400 italic flex items-center justify-center">
                            K·∫øt qu·∫£ code s·∫Ω hi·ªán ·ªü ƒë√¢y...
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sub-Tabs -->
            <div class="flex flex-wrap gap-2 mb-6 no-print tab-buttons-container">
                <button onclick="switchSubTab('dml', 'update')" class="tab-btn-dml active px-4 py-2 rounded-lg text-sm transition border border-slate-200" data-target="update">1. C·∫≠p nh·∫≠t D·ªØ li·ªáu</button>
                <button onclick="switchSubTab('dml', 'query')" class="tab-btn-dml px-4 py-2 rounded-lg text-sm transition border border-transparent bg-slate-100 text-slate-600 hover:bg-slate-200" data-target="query">2. Truy v·∫•n & T·∫≠p h·ª£p</button>
                <button onclick="switchSubTab('dml', 'group')" class="tab-btn-dml px-4 py-2 rounded-lg text-sm transition border border-transparent bg-slate-100 text-slate-600 hover:bg-slate-200" data-target="group">3. Th·ªëng k√™ & Gom nh√≥m</button>
                <button onclick="switchSubTab('dml', 'div')" class="tab-btn-dml px-4 py-2 rounded-lg text-sm transition border border-transparent bg-slate-100 text-slate-600 hover:bg-slate-200" data-target="div">4. Ph√©p Chia</button>
            </div>

            <!-- 1.2.1 Update -->
            <div id="dml-update" class="dml-content block">
                <div class="space-y-6" id="code-dml-ops">
                    <div class="bg-white p-5 rounded-lg border border-green-200 shadow-sm relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-green-500"></div>
                        <h4 class="text-green-800 font-bold text-sm mb-2 uppercase tracking-wide">1. INSERT (Th√™m m·ªõi)</h4>
                        <p class="text-sm text-slate-600 mb-2">Th√™m d√≤ng d·ªØ li·ªáu m·ªõi. C·∫ßn li·ªát k√™ ƒë√∫ng th·ª© t·ª± c·ªôt ho·∫∑c ch·ªâ ƒë·ªãnh t√™n c·ªôt.</p>
                        <div class="code-block p-3 rounded text-sm">INSERT INTO SinhVien (MaSV, HoTen) VALUES ('SV01', N'Nguy·ªÖn VƒÉn A');</div>
                    </div>
                    <div class="bg-white p-5 rounded-lg border border-blue-200 shadow-sm relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-blue-500"></div>
                        <h4 class="text-blue-800 font-bold text-sm mb-2 uppercase tracking-wide">2. UPDATE (S·ª≠a ƒë·ªïi)</h4>
                        <p class="text-sm text-slate-600 mb-2">C·∫≠p nh·∫≠t gi√° tr·ªã. <b class="text-red-500">L∆∞u √Ω:</b> Lu√¥n nh·ªõ d√πng <code>WHERE</code>, n·∫øu kh√¥ng s·∫Ω s·ª≠a to√†n b·ªô b·∫£ng!</p>
                        <div class="code-block p-3 rounded text-sm">UPDATE SinhVien SET DiemTB = 9.0 WHERE MaSV = 'SV01';</div>
                    </div>
                    <div class="bg-white p-5 rounded-lg border border-red-200 shadow-sm relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-red-500"></div>
                        <h4 class="text-red-800 font-bold text-sm mb-2 uppercase tracking-wide">3. DELETE (X√≥a)</h4>
                        <p class="text-sm text-slate-600 mb-2">X√≥a d√≤ng d·ªØ li·ªáu. C≈©ng c·∫ßn <code>WHERE</code> ƒë·ªÉ tr√°nh x√≥a s·∫°ch b·∫£ng.</p>
                        <div class="code-block p-3 rounded text-sm">DELETE FROM SinhVien WHERE MaLop = 'L01';</div>
                    </div>
                </div>
                <button onclick="explainCode('code-dml-ops', 'expl-dml-ops', 'Gi·∫£i th√≠ch chi ti·∫øt, ƒë·∫∑c bi·ªát l√† r·ªßi ro khi qu√™n WHERE trong UPDATE/DELETE.')" class="mt-6 ai-btn text-xs bg-indigo-600 text-white px-4 py-2 rounded shadow-sm hover:bg-indigo-700 transition no-print flex items-center gap-2 w-fit">
                    <span class="material-symbols-outlined text-sm">smart_toy</span> AI: Gi·∫£i th√≠ch Thao t√°c DL
                </button>
                <div id="expl-dml-ops" class="ai-explanation-box"></div>
            </div>

            <!-- 1.2.2 Query -->
            <div id="dml-query" class="dml-content hidden">
                <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                    <h3 class="font-bold text-slate-800 mb-4 border-b pb-2">Truy v·∫•n tr√™n T·∫≠p h·ª£p (Set Operations)</h3>
                    <div class="flex flex-col md:flex-row gap-8 items-center mb-6">
                        <div class="venn-container">
                            <div class="venn-circle venn-a text-white">A</div>
                            <div class="venn-circle venn-b text-white">B</div>
                        </div>
                        <div class="text-sm space-y-2 flex-1">
                            <p><span class="font-bold text-indigo-600 bg-indigo-50 px-1 rounded">UNION</span>: G·ªôp (A+B). T·ª± ƒë·ªông lo·∫°i b·ªè tr√πng l·∫∑p.</p>
                            <p><span class="font-bold text-purple-600 bg-purple-50 px-1 rounded">INTERSECT</span>: L·∫•y ph·∫ßn chung (Giao nhau) c·ªßa A v√† B.</p>
                            <p><span class="font-bold text-pink-600 bg-pink-50 px-1 rounded">EXCEPT</span>: L·∫•y ph·∫ßn c√≥ trong A nh∆∞ng KH√îNG c√≥ trong B (Ph√©p tr·ª´).</p>
                        </div>
                    </div>
                    <div class="code-block p-4 rounded-lg text-sm" id="code-sets">
<span class="sql-com">-- V√≠ d·ª•: T√¨m c√°c sinh vi√™n h·ªçc To√°n HO·∫∂C h·ªçc L√Ω</span>
<span class="sql-kw">SELECT</span> MaSV <span class="sql-kw">FROM</span> DiemToan
<span class="sql-kw">UNION</span>
<span class="sql-kw">SELECT</span> MaSV <span class="sql-kw">FROM</span> DiemLy;
                    </div>
                    <button onclick="explainCode('code-sets', 'expl-sets', 'Gi·∫£i th√≠ch s·ª± kh√°c nhau gi·ªØa UNION v√† UNION ALL.')" class="mt-4 ai-btn text-xs bg-indigo-600 text-white px-4 py-2 rounded shadow-sm hover:bg-indigo-700 transition no-print flex items-center gap-2 w-fit">
                        <span class="material-symbols-outlined text-sm">smart_toy</span> AI: Gi·∫£i th√≠ch T·∫≠p h·ª£p
                    </button>
                    <div id="expl-sets" class="ai-explanation-box"></div>
                </div>
            </div>

            <!-- 1.2.3 Group -->
            <div id="dml-group" class="dml-content hidden">
                <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                    <h3 class="font-bold text-slate-800 mb-2">Th·ªëng k√™ & Gom nh√≥m</h3>
                    <p class="text-sm text-slate-600 mb-4 italic">"Cho t√¥i bi·∫øt m·ªói khoa c√≥ bao nhi√™u sinh vi√™n?" -> D√πng GROUP BY.</p>
                    
                    <div class="bg-slate-50 p-3 rounded mb-4 border border-slate-200">
                        <p class="text-xs font-bold text-slate-500 uppercase mb-1">Th·ª© t·ª± th·ª±c thi Logic:</p>
                        <div class="flex items-center gap-2 text-xs font-mono text-slate-700 overflow-x-auto">
                            <span>1. FROM/JOIN</span>
                            <span>‚Üí</span>
                            <span>2. WHERE (L·ªçc d√≤ng)</span>
                            <span>‚Üí</span>
                            <span class="bg-yellow-200 px-1 rounded">3. GROUP BY (Gom)</span>
                            <span>‚Üí</span>
                            <span class="bg-yellow-200 px-1 rounded">4. HAVING (L·ªçc nh√≥m)</span>
                            <span>‚Üí</span>
                            <span>5. SELECT</span>
                        </div>
                    </div>

                    <div class="code-block p-4 rounded-lg text-sm" id="code-group">
<span class="sql-kw">SELECT</span> Khoa, <span class="sql-fn">COUNT</span>(*) <span class="sql-kw">AS</span> SoLuong
<span class="sql-kw">FROM</span> SinhVien
<span class="sql-kw">GROUP BY</span> Khoa
<span class="sql-kw">HAVING</span> <span class="sql-fn">COUNT</span>(*) > 50; <span class="sql-com">-- Ch·ªâ l·∫•y khoa ƒë√¥ng SV</span>
                    </div>
                    <button onclick="explainCode('code-group', 'expl-group', 'Gi·∫£i th√≠ch t·∫°i sao kh√¥ng d√πng WHERE cho COUNT(*) ƒë∆∞·ª£c m√† ph·∫£i d√πng HAVING.')" class="mt-4 ai-btn text-xs bg-indigo-600 text-white px-4 py-2 rounded shadow-sm hover:bg-indigo-700 transition no-print flex items-center gap-2 w-fit">
                        <span class="material-symbols-outlined text-sm">smart_toy</span> AI: Gi·∫£i th√≠ch GROUP BY
                    </button>
                    <div id="expl-group" class="ai-explanation-box"></div>
                </div>
            </div>

            <!-- 1.2.4 Division -->
            <div id="dml-div" class="dml-content hidden">
                <div class="bg-indigo-50 border border-indigo-200 p-5 rounded-lg mb-6">
                    <h3 class="text-indigo-900 font-bold mb-2 flex items-center gap-2">
                        <span class="material-symbols-outlined">psychology</span> Ph√©p Chia (Relational Division)
                    </h3>
                    <p class="text-sm text-indigo-800 mb-2">B√†i to√°n kinh ƒëi·ªÉn: <b>"T√¨m sinh vi√™n ƒë√£ h·ªçc T·∫§T C·∫¢ c√°c m√¥n h·ªçc".</b></p>
                    <p class="text-xs text-indigo-700 italic">C√°ch t∆∞ duy: T√¨m nh·ªØng SV m√† "Kh√¥ng c√≥ m√¥n h·ªçc n√†o m√† SV ƒë√≥ kh√¥ng h·ªçc" (Ph·ªß ƒë·ªãnh c·ªßa ph·ªß ƒë·ªãnh).</p>
                </div>
                <div class="code-block p-4 rounded-lg text-sm shadow-md" id="code-div">
<span class="sql-kw">SELECT</span> * <span class="sql-kw">FROM</span> SinhVien SV
<span class="sql-kw">WHERE NOT EXISTS</span> (
    <span class="sql-kw">SELECT</span> * <span class="sql-kw">FROM</span> MonHoc MH
    <span class="sql-kw">WHERE NOT EXISTS</span> (
        <span class="sql-kw">SELECT</span> * <span class="sql-kw">FROM</span> KetQua KQ
        <span class="sql-kw">WHERE</span> KQ.MaSV = SV.MaSV 
        <span class="sql-kw">AND</span> KQ.MaMH = MH.MaMH
    )
);
                </div>
                <button onclick="explainCode('code-div', 'expl-div', 'Gi·∫£i th√≠ch logic 2 l·∫ßn NOT EXISTS m·ªôt c√°ch d·ªÖ hi·ªÉu nh·∫•t.')" class="mt-4 ai-btn text-xs bg-indigo-600 text-white px-4 py-2 rounded shadow-sm hover:bg-indigo-700 transition no-print flex items-center gap-2 w-fit">
                    <span class="material-symbols-outlined text-sm">smart_toy</span> AI: Gi·∫£i th√≠ch Logic
                </button>
                <div id="expl-div" class="ai-explanation-box"></div>
            </div>
        </section>

        <!-- 1.3 TRIGGERS SECTION -->
        <section id="triggers" class="content-section max-w-5xl mx-auto mb-16 animate-fade-in hidden">
            <div class="flex items-center gap-3 mb-6 border-b border-slate-200 pb-4">
                <div class="bg-amber-100 text-amber-700 p-2 rounded-lg"><span class="material-symbols-outlined">bolt</span></div>
                <div>
                    <h2 class="text-2xl font-bold text-slate-800">1.3 Trigger</h2>
                    <p class="text-slate-500 text-sm">Trigger l√† ƒëo·∫°n code SQL t·ª± ƒë·ªông ch·∫°y khi c√≥ s·ª± ki·ªán INSERT, UPDATE, DELETE.</p>
                </div>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">
                <div class="space-y-4">
                    <div class="bg-amber-50 border border-amber-200 p-4 rounded-lg">
                        <h4 class="font-bold text-amber-800 text-sm mb-2">‚ö° Trigger l√† g√¨?</h4>
                        <ul class="text-sm text-amber-800 space-y-1">
                            <li>‚Ä¢ T·ª± ƒë·ªông k√≠ch ho·∫°t khi c√≥ thay ƒë·ªïi d·ªØ li·ªáu</li>
                            <li>‚Ä¢ BEFORE/AFTER: Ch·∫°y tr∆∞·ªõc hay sau s·ª± ki·ªán</li>
                            <li>‚Ä¢ D√πng ƒë·ªÉ: Ki·ªÉm tra d·ªØ li·ªáu, ghi log, ƒë·ªìng b·ªô b·∫£ng</li>
                        </ul>
                    </div>
                    <div class="flow-node bg-white p-3 border border-slate-200 rounded">
                        <div class="text-xs text-center">
                            <span class="font-bold text-indigo-600">INSERT/UPDATE/DELETE</span>
                            <span class="material-symbols-outlined text-sm mx-2">arrow_forward</span>
                            <span class="font-bold text-amber-600">TRIGGER</span>
                            <span class="material-symbols-outlined text-sm mx-2">arrow_forward</span>
                            <span class="font-bold text-green-600">H√†nh ƒë·ªông</span>
                        </div>
                    </div>
                </div>
                <div class="code-block p-4 rounded-lg shadow-sm" id="code-trigger">
<span class="sql-com">-- Trigger ghi log khi x√≥a sinh vi√™n</span>
<span class="sql-kw">CREATE TRIGGER</span> trg_LogXoaSV
<span class="sql-kw">ON</span> SinhVien
<span class="sql-kw">AFTER DELETE</span>
<span class="sql-kw">AS</span>
<span class="sql-kw">BEGIN</span>
    <span class="sql-kw">INSERT INTO</span> LogXoa (MaSV, NgayXoa)
    <span class="sql-kw">SELECT</span> MaSV, <span class="sql-fn">GETDATE</span>() 
    <span class="sql-kw">FROM</span> deleted;
<span class="sql-kw">END</span>;

<span class="sql-com">-- Trigger ki·ªÉm tra ƒëi·ªÉm tr∆∞·ªõc khi th√™m</span>
<span class="sql-kw">CREATE TRIGGER</span> trg_CheckDiem
<span class="sql-kw">ON</span> SinhVien
<span class="sql-kw">BEFORE INSERT</span>
<span class="sql-kw">AS</span>
<span class="sql-kw">BEGIN</span>
    <span class="sql-kw">IF</span> (NEW.DiemTB < 0 <span class="sql-kw">OR</span> NEW.DiemTB > 10)
        <span class="sql-kw">SIGNAL SQLSTATE</span> <span class="sql-str">'45000'</span> 
        <span class="sql-kw">SET MESSAGE_TEXT</span> = <span class="sql-str">'ƒêi·ªÉm ph·∫£i t·ª´ 0-10'</span>;
<span class="sql-kw">END</span>;
                </div>
            </div>
        </section>

        <!-- 2.1 KEYS SECTION (Closure) -->
        <section id="keys" class="content-section max-w-5xl mx-auto mb-16 animate-fade-in hidden">
            <div class="flex items-center gap-3 mb-6 border-b border-slate-200 pb-4">
                <div class="bg-yellow-100 text-yellow-700 p-2 rounded-lg"><span class="material-symbols-outlined">key</span></div>
                <div>
                    <h2 class="text-2xl font-bold text-slate-800">2.1 T√¨m Kh√≥a (Bao ƒë√≥ng)</h2>
                    <p class="text-slate-500 text-sm">Thu·∫≠t to√°n t√≠nh bao ƒë√≥ng thu·ªôc t√≠nh ƒë·ªÉ t√¨m kh√≥a ·ª©ng vi√™n.</p>
                </div>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">
                <div class="space-y-4">
                    <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
                        <h4 class="font-bold text-yellow-800 text-sm mb-2">üîë Bao ƒë√≥ng thu·ªôc t√≠nh X‚Å∫</h4>
                        <p class="text-sm text-yellow-800 mb-2">L√† t·∫≠p h·ª£p t·∫•t c·∫£ thu·ªôc t√≠nh c√≥ th·ªÉ suy ra t·ª´ X d·ª±a tr√™n t·∫≠p ph·ª• thu·ªôc h√†m F.</p>
                        <p class="text-sm text-yellow-700">N·∫øu X‚Å∫ ch·ª©a t·∫•t c·∫£ thu·ªôc t√≠nh ‚Üí X l√† si√™u kh√≥a.</p>
                    </div>
                </div>

                <div class="bg-white p-4 rounded-lg border border-slate-200 space-y-4">
                    <div>
                        <label class="text-xs font-bold text-slate-600 block mb-1">Thu·ªôc t√≠nh ƒë·∫ßu v√†o (X):</label>
                        <input id="closure-input" type="text" placeholder="A, B" class="w-full border border-slate-300 rounded px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-300 focus:border-indigo-500">
                    </div>
                    <div>
                        <label class="text-xs font-bold text-slate-600 block mb-1">T·∫≠p ph·ª• thu·ªôc h√†m F (m·ªói d√≤ng 1 PTH):</label>
                        <textarea id="fds-input" rows="4" placeholder="A,B -> C&#10;C -> D&#10;D -> E" class="w-full border border-slate-300 rounded px-3 py-2 text-sm font-mono focus:ring-2 focus:ring-indigo-300 focus:border-indigo-500"></textarea>
                    </div>
                    <button onclick="calculateClosure()" class="w-full bg-indigo-600 text-white py-2 rounded font-bold hover:bg-indigo-700 transition text-sm">T√≠nh Bao ƒê√≥ng X‚Å∫</button>
                    <div id="closure-result" class="p-3 bg-slate-50 rounded border text-sm text-slate-700 min-h-[60px]"></div>
                </div>
            </div>
        </section>

        <!-- 2.2 NORMALIZATION SECTION -->
        <section id="normalization" class="content-section max-w-5xl mx-auto mb-16 animate-fade-in hidden">
            <div class="flex items-center gap-3 mb-6 border-b border-slate-200 pb-4">
                <div class="bg-teal-100 text-teal-700 p-2 rounded-lg"><span class="material-symbols-outlined">checklist</span></div>
                <div>
                    <h2 class="text-2xl font-bold text-slate-800">2.2 D·∫°ng Chu·∫©n (NF)</h2>
                    <p class="text-slate-500 text-sm">Ki·ªÉm tra l∆∞·ª£c ƒë·ªì ƒë·∫°t chu·∫©n m·∫•y: 1NF, 2NF, 3NF, BCNF.</p>
                </div>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">
                <!-- Theory Cards -->
                <div class="space-y-3">
                    <div class="p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                        <h4 class="font-bold text-slate-700 mb-2 flex items-center gap-2">
                            <span class="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded">1NF</span> First Normal Form
                        </h4>
                        <p class="text-xs text-slate-600">M·ªói √¥ ch·ªâ ch·ª©a 1 gi√° tr·ªã nguy√™n t·ª≠ (kh√¥ng l·∫∑p, kh√¥ng ph·ª©c h·ª£p).</p>
                    </div>
                    <div class="p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                        <h4 class="font-bold text-slate-700 mb-2 flex items-center gap-2">
                            <span class="text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded">2NF</span> Second Normal Form
                        </h4>
                        <p class="text-xs text-slate-600">ƒê·∫°t 1NF + Kh√¥ng c√≥ ph·ª• thu·ªôc b·ªô ph·∫≠n (thu·ªôc t√≠nh kh√¥ng kh√≥a ph·ª• thu·ªôc v√†o m·ªôt ph·∫ßn kh√≥a).</p>
                    </div>
                    <div class="p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                        <h4 class="font-bold text-slate-700 mb-2 flex items-center gap-2">
                            <span class="text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded">3NF</span> Third Normal Form
                        </h4>
                        <p class="text-xs text-slate-600">ƒê·∫°t 2NF + Kh√¥ng c√≥ ph·ª• thu·ªôc b·∫Øc c·∫ßu (A‚ÜíB‚ÜíC th√¨ ph·∫£i t√°ch C ri√™ng).</p>
                    </div>
                    <div class="p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                        <h4 class="font-bold text-slate-700 mb-2 flex items-center gap-2">
                            <span class="text-xs bg-amber-100 text-amber-700 px-2 py-0.5 rounded">BCNF</span> Boyce-Codd NF
                        </h4>
                        <p class="text-xs text-slate-600">V·ªõi m·ªçi X‚ÜíA, X ph·∫£i l√† si√™u kh√≥a (m·∫°nh h∆°n 3NF).</p>
                    </div>
                </div>

                <!-- AI Check Tool -->
                <div class="bg-white p-4 rounded-lg border border-slate-200 space-y-4">
                    <label class="text-xs font-bold text-slate-600 block mb-1">Nh·∫≠p l∆∞·ª£c ƒë·ªì v√† t·∫≠p ph·ª• thu·ªôc h√†m:</label>
                    <textarea id="nf-input" rows="5" placeholder="R(A, B, C, D)&#10;F = { A -> B, B -> C, A -> D }" class="w-full border border-slate-300 rounded px-3 py-2 text-sm font-mono focus:ring-2 focus:ring-indigo-300 focus:border-indigo-500"></textarea>
                    <button onclick="checkNormalForm()" class="w-full bg-teal-600 text-white py-2 rounded font-bold hover:bg-teal-700 transition text-sm flex items-center justify-center gap-2">
                        <span class="material-symbols-outlined text-sm">smart_toy</span> AI: Ki·ªÉm tra D·∫°ng Chu·∫©n
                    </button>
                    <div id="nf-result" class="hidden p-3 bg-teal-50 rounded border border-teal-200 text-sm text-teal-800"></div>
                </div>
            </div>
        </section>

        <!-- 2.3 DECOMPOSITION SECTION -->
        <section id="decomposition" class="content-section max-w-5xl mx-auto mb-16 animate-fade-in hidden">
            <div class="flex items-center gap-3 mb-6 border-b border-slate-200 pb-4">
                <div class="bg-pink-100 text-pink-700 p-2 rounded-lg"><span class="material-symbols-outlined">call_split</span></div>
                <div>
                    <h2 class="text-2xl font-bold text-slate-800">2.3 Ph√¢n R√£ (Decomposition)</h2>
                    <p class="text-slate-500 text-sm">Ph√¢n r√£ l∆∞·ª£c ƒë·ªì th√†nh c√°c b·∫£ng nh·ªè h∆°n ƒë·∫°t 3NF/BCNF.</p>
                </div>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">
                <div class="space-y-4">
                    <div class="bg-pink-50 border border-pink-200 p-4 rounded-lg">
                        <h4 class="font-bold text-pink-800 text-sm mb-2">‚úÇÔ∏è M·ª•c ti√™u ph√¢n r√£</h4>
                        <ul class="text-sm text-pink-800 space-y-1">
                            <li>‚Ä¢ <b>B·∫£o to√†n th√¥ng tin:</b> Kh√¥ng m·∫•t d·ªØ li·ªáu khi JOIN l·∫°i</li>
                            <li>‚Ä¢ <b>B·∫£o to√†n ph·ª• thu·ªôc:</b> Gi·ªØ ƒë∆∞·ª£c c√°c r√†ng bu·ªôc F</li>
                            <li>‚Ä¢ <b>ƒê·∫°t chu·∫©n cao:</b> 3NF ho·∫∑c BCNF</li>
                        </ul>
                    </div>
                </div>

                <div class="bg-white p-4 rounded-lg border border-slate-200 space-y-4">
                    <label class="text-xs font-bold text-slate-600 block mb-1">Nh·∫≠p l∆∞·ª£c ƒë·ªì c·∫ßn ph√¢n r√£:</label>
                    <textarea id="decomp-input" rows="5" placeholder="R(A, B, C, D, E)&#10;F = { A -> B, B -> C, C -> D }" class="w-full border border-slate-300 rounded px-3 py-2 text-sm font-mono focus:ring-2 focus:ring-indigo-300 focus:border-indigo-500"></textarea>
                    <button onclick="suggestDecomp()" class="w-full bg-pink-600 text-white py-2 rounded font-bold hover:bg-pink-700 transition text-sm flex items-center justify-center gap-2">
                        <span class="material-symbols-outlined text-sm">smart_toy</span> AI: G·ª£i √Ω Ph√¢n R√£
                    </button>
                    <div id="decomp-result" class="hidden p-3 bg-pink-50 rounded border border-pink-200 text-sm text-pink-800"></div>
                </div>
            </div>
        </section>

        <!-- 3.1 EXERCISES SECTION -->
        <section id="exercises-section" class="content-section max-w-6xl mx-auto mb-16 animate-fade-in hidden">
            <div class="flex items-center gap-3 mb-6 border-b border-slate-200 pb-4">
                <div class="bg-orange-100 text-orange-700 p-2 rounded-lg"><span class="material-symbols-outlined">fitness_center</span></div>
                <div>
                    <h2 class="text-2xl font-bold text-slate-800">3.1 B√†i T·∫≠p & Th·ª≠ Th√°ch</h2>
                    <p class="text-slate-500 text-sm">Luy·ªán t·∫≠p SQL v·ªõi c√°c b√†i t·∫≠p t·ª´ c∆° b·∫£n ƒë·∫øn n√¢ng cao.</p>
                </div>
            </div>

            <div class="grid lg:grid-cols-7 gap-6">
                <!-- Exercise List -->
                <div class="lg:col-span-3 bg-white rounded-lg border border-slate-200 p-4 max-h-[600px] overflow-y-auto custom-scroll">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-slate-700">Danh s√°ch b√†i t·∫≠p</h3>
                        <button onclick="openAIExerciseModal()" class="text-xs bg-indigo-100 text-indigo-700 px-3 py-1 rounded font-bold hover:bg-indigo-200 transition no-print">+ AI T·∫°o m·ªõi</button>
                    </div>
                    <div id="exercise-list" class="space-y-1"></div>
                </div>

                <!-- Exercise Workspace -->
                <div class="lg:col-span-4 bg-white rounded-lg border border-slate-200 p-4">
                    <div id="exercise-empty-state" class="flex flex-col items-center justify-center h-64 text-slate-400">
                        <span class="material-symbols-outlined text-5xl mb-2">touch_app</span>
                        <p class="text-sm">Ch·ªçn m·ªôt b√†i t·∫≠p b√™n tr√°i ƒë·ªÉ b·∫Øt ƒë·∫ßu</p>
                    </div>
                    <div id="exercise-workspace" class="hidden space-y-4">
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 id="ex-title" class="font-bold text-lg text-slate-800"></h3>
                                <span id="ex-difficulty" class="text-xs font-bold bg-slate-100 text-slate-600 px-2 py-0.5 rounded"></span>
                            </div>
                            <button onclick="showExerciseAnswer()" class="text-xs text-slate-500 hover:text-indigo-600 flex items-center gap-1 no-print">
                                <span class="material-symbols-outlined text-sm">visibility</span> Xem ƒë√°p √°n
                            </button>
                        </div>
                        <div id="ex-desc" class="text-sm text-slate-600 bg-slate-50 p-3 rounded border"></div>
                        <div class="text-xs text-slate-500">B·∫£ng c√≥ s·∫µn: <span id="ex-tables" class="font-mono text-indigo-600"></span></div>
                        <textarea id="ex-editor" rows="4" placeholder="Vi·∫øt c√¢u l·ªánh SQL ·ªü ƒë√¢y..." class="w-full border border-slate-300 rounded px-3 py-2 font-mono text-sm focus:ring-2 focus:ring-indigo-300 focus:border-indigo-500"></textarea>
                        <div class="flex gap-2">
                            <button onclick="checkExercise()" class="flex-1 bg-green-600 text-white py-2 rounded font-bold hover:bg-green-700 transition text-sm">Ki·ªÉm tra</button>
                        </div>
                        <div id="ex-feedback" class="text-sm font-bold"></div>
                        <div id="ex-result" class="max-h-40 overflow-auto border border-slate-200 rounded bg-slate-50"></div>
                    </div>
                </div>
            </div>

            <!-- Printable version (hidden, shown only in print) -->
            <div id="printable-exercises" class="hidden"></div>
        </section>

        <!-- 4.1 SQL LIVE DEMO SECTION -->
        <section id="demo" class="content-section max-w-6xl mx-auto mb-16 animate-fade-in hidden">
            <div class="flex items-center gap-3 mb-6 border-b border-slate-200 pb-4">
                <div class="bg-cyan-100 text-cyan-700 p-2 rounded-lg"><span class="material-symbols-outlined">terminal</span></div>
                <div>
                    <h2 class="text-2xl font-bold text-slate-800">4.1 SQL Live Demo</h2>
                    <p class="text-slate-500 text-sm">Th·ª±c h√†nh SQL tr·ª±c ti·∫øp trong tr√¨nh duy·ªát.</p>
                </div>
            </div>

            <div class="grid lg:grid-cols-3 gap-6">
                <!-- Left: Schema & Controls -->
                <div class="space-y-4">
                    <!-- Dataset Selector -->
                    <div class="bg-white p-4 rounded-lg border border-slate-200">
                        <h4 class="text-xs font-bold text-slate-600 mb-2 uppercase tracking-wide">Ch·ªçn Database</h4>
                        <div class="flex gap-2 flex-wrap">
                            <button onclick="loadSampleDataset('school')" class="text-xs bg-indigo-100 text-indigo-700 px-3 py-1.5 rounded font-bold hover:bg-indigo-200 transition">üéì Tr∆∞·ªùng h·ªçc</button>
                            <button onclick="loadSampleDataset('ecommerce')" class="text-xs bg-green-100 text-green-700 px-3 py-1.5 rounded font-bold hover:bg-green-200 transition">üõí E-Commerce</button>
                            <button onclick="loadSampleDataset('hr')" class="text-xs bg-amber-100 text-amber-700 px-3 py-1.5 rounded font-bold hover:bg-amber-200 transition">üëî Nh√¢n s·ª±</button>
                        </div>
                        <select id="db-selector" onchange="switchDB(this.value)" class="mt-3 w-full border border-slate-300 rounded px-2 py-1.5 text-sm">
                            <option>-- Ch·ªçn DB --</option>
                        </select>
                    </div>

                    <!-- Schema Viewer -->
                    <div class="bg-white p-4 rounded-lg border border-slate-200">
                        <h4 class="text-xs font-bold text-slate-600 mb-2 uppercase tracking-wide">Schema (B·∫•m ƒë·ªÉ xem data)</h4>
                        <div id="schema-container" class="space-y-2 max-h-60 overflow-y-auto custom-scroll"></div>
                    </div>

                    <!-- ERD Button -->
                    <button onclick="toggleVisualizer()" class="w-full bg-slate-100 text-slate-700 py-2 rounded font-bold hover:bg-slate-200 transition text-sm flex items-center justify-center gap-2 no-print">
                        <span class="material-symbols-outlined text-sm">schema</span> Xem ERD
                    </button>
                </div>

                <!-- Right: Editor & Results -->
                <div class="lg:col-span-2 space-y-4">
                    <!-- AI Generate -->
                    <div class="bg-gradient-to-r from-indigo-500 to-purple-600 p-4 rounded-lg text-white no-print">
                        <h4 class="font-bold text-sm mb-2 flex items-center gap-2"><span class="material-symbols-outlined text-lg">auto_awesome</span> AI: Vi·∫øt SQL t·ª´ y√™u c·∫ßu</h4>
                        <div class="flex gap-2">
                            <input id="demo-ai-input" type="text" placeholder="VD: L·∫•y sinh vi√™n ƒëi·ªÉm cao nh·∫•t m·ªói l·ªõp" class="flex-1 px-3 py-2 rounded text-slate-800 text-sm focus:outline-none">
                            <button onclick="generateDemoSQL()" class="bg-white text-indigo-600 px-4 py-2 rounded font-bold text-sm hover:bg-slate-100 transition">Vi·∫øt SQL</button>
                        </div>
                        <div id="demo-ai-result-container" class="hidden mt-3 bg-white/10 rounded p-3">
                            <pre id="demo-ai-output" class="text-xs font-mono whitespace-pre-wrap"></pre>
                            <button onclick="runGeneratedSQL()" class="mt-2 text-xs bg-white text-indigo-600 px-3 py-1 rounded font-bold">Ch·∫°y code n√†y</button>
                        </div>
                    </div>

                    <!-- SQL Editor -->
                    <div class="bg-white rounded-lg border border-slate-200 overflow-hidden">
                        <div class="bg-slate-100 px-4 py-2 flex items-center justify-between border-b">
                            <span class="text-xs font-bold text-slate-600">SQL Editor</span>
                            <div class="flex gap-2">
                                <button onclick="explainCurrentQuery()" class="text-xs text-slate-500 hover:text-indigo-600 flex items-center gap-1 no-print">
                                    <span class="material-symbols-outlined text-sm">help</span> Gi·∫£i th√≠ch
                                </button>
                                <button onclick="fixCurrentQuery()" class="text-xs text-slate-500 hover:text-green-600 flex items-center gap-1 no-print">
                                    <span class="material-symbols-outlined text-sm">build</span> S·ª≠a l·ªói
                                </button>
                            </div>
                        </div>
                        <textarea id="sql-editor" rows="6" placeholder="-- Vi·∫øt SQL t·∫°i ƒë√¢y&#10;SELECT * FROM SinhVien;" class="w-full px-4 py-3 font-mono text-sm focus:outline-none resize-none"></textarea>
                        <div class="bg-slate-50 px-4 py-2 flex justify-between items-center border-t">
                            <span class="text-xs text-slate-500">K·∫øt qu·∫£: <span id="row-count">-</span></span>
                            <div class="flex gap-2">
                                <button onclick="exportData('csv')" class="text-xs text-slate-500 hover:text-green-600 no-print">üì• CSV</button>
                                <button onclick="exportData('json')" class="text-xs text-slate-500 hover:text-blue-600 no-print">üì• JSON</button>
                                <button onclick="shareQuery()" class="text-xs text-slate-500 hover:text-purple-600 no-print">üîó Share</button>
                                <button onclick="runDemoQuery()" class="bg-green-600 text-white px-4 py-1.5 rounded font-bold text-xs hover:bg-green-700 transition">‚ñ∂ Ch·∫°y</button>
                            </div>
                        </div>
                    </div>

                    <!-- Query Result -->
                    <div class="bg-white rounded-lg border border-slate-200 p-4 max-h-80 overflow-auto custom-scroll">
                        <h4 class="text-xs font-bold text-slate-600 mb-2 uppercase tracking-wide">K·∫øt qu·∫£</h4>
                        <div id="query-result-container" class="text-sm"></div>
                    </div>
                </div>
            </div>

            <!-- ERD Visualizer (Hidden by default) -->
            <div id="erd-visualizer" class="hidden mt-6 bg-white rounded-lg border border-slate-200 p-4 no-print">
                <div class="flex justify-between items-center mb-4">
                    <h4 class="font-bold text-slate-700">Entity Relationship Diagram</h4>
                    <button onclick="toggleVisualizer()" class="text-slate-400 hover:text-slate-600">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
                <div id="erd-canvas" class="h-96 bg-slate-50 rounded border relative overflow-hidden">
                    <svg id="erd-svg" width="100%" height="100%"></svg>
                </div>
            </div>
        </section>

    </main>

    <!-- AUTH MODAL -->
    <div id="auth-modal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm p-6 relative">
            <button onclick="closeAuthModal()" class="absolute top-3 right-3 text-slate-400 hover:text-slate-600">
                <span class="material-symbols-outlined">close</span>
            </button>
            <h3 id="auth-title" class="text-xl font-bold text-slate-800 mb-4">ƒêƒÉng Nh·∫≠p</h3>
            <div class="space-y-4">
                <input id="auth-username" type="text" placeholder="T√™n ƒëƒÉng nh·∫≠p" class="w-full border border-slate-300 rounded px-4 py-2.5 focus:ring-2 focus:ring-indigo-300 focus:border-indigo-500">
                <input id="auth-password" type="password" placeholder="M·∫≠t kh·∫©u" class="w-full border border-slate-300 rounded px-4 py-2.5 focus:ring-2 focus:ring-indigo-300 focus:border-indigo-500">
                <button id="auth-submit-btn" onclick="handleAuthSubmit()" class="w-full bg-indigo-600 text-white py-2.5 rounded font-bold hover:bg-indigo-700 transition">ƒêƒÉng Nh·∫≠p</button>
                <p id="auth-switch-text" class="text-center text-sm text-slate-500"></p>
            </div>
        </div>
    </div>

    <!-- SETTINGS MODAL -->
    <div id="settings-modal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 overflow-y-auto">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl my-8 relative">
            <!-- Header -->
            <div class="sticky top-0 bg-white px-6 py-4 border-b border-slate-200 rounded-t-xl flex items-center justify-between z-10">
                <h3 class="text-xl font-bold text-slate-800 flex items-center gap-2">
                    <span class="material-symbols-outlined">settings</span> C√†i ƒë·∫∑t chung
                </h3>
                <button onclick="closeSettings()" class="text-slate-400 hover:text-slate-600 p-1 hover:bg-slate-100 rounded">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>

            <!-- Content -->
            <div class="p-6 space-y-6 max-h-[70vh] overflow-y-auto custom-scroll">

                <!-- 1. GIAO DI·ªÜN -->
                <div class="settings-group">
                    <h4 class="settings-group-title"><span class="material-symbols-outlined text-sm">palette</span> Giao di·ªán</h4>
                    <div class="settings-group-content">
                        <div class="settings-row">
                            <label class="settings-label">Ch·ªß ƒë·ªÅ m√†u s·∫Øc</label>
                            <select id="setting-theme" onchange="updateSetting('theme', this.value)" class="settings-select">
                                <option value="light">S√°ng</option>
                                <option value="dark">T·ªëi</option>
                                <option value="system">Theo h·ªá th·ªëng</option>
                            </select>
                        </div>
                        <div class="settings-row">
                            <label class="settings-label">B·∫≠t Animation & Shadow</label>
                            <input type="checkbox" id="setting-effects" onchange="updateSetting('effectsEnabled', this.checked)" class="settings-checkbox">
                        </div>
                    </div>
                </div>

                <!-- 2. TR√åNH SO·∫†N TH·∫¢O SQL -->
                <div class="settings-group">
                    <h4 class="settings-group-title"><span class="material-symbols-outlined text-sm">code</span> Tr√¨nh so·∫°n th·∫£o SQL</h4>
                    <div class="settings-group-content">
                        <div class="settings-row">
                            <label class="settings-label">C·ª° ch·ªØ</label>
                            <select id="setting-editor-font-size" onchange="updateSetting('editorFontSize', parseInt(this.value))" class="settings-select">
                                <option value="12">12px</option>
                                <option value="14">14px</option>
                                <option value="16">16px</option>
                                <option value="18">18px</option>
                            </select>
                        </div>
                        <div class="settings-row">
                            <label class="settings-label">Font ch·ªØ</label>
                            <select id="setting-editor-font-family" onchange="updateSetting('editorFontFamily', this.value)" class="settings-select">
                                <option value="Fira Code">Fira Code</option>
                                <option value="JetBrains Mono">JetBrains Mono</option>
                                <option value="Consolas">Consolas</option>
                                <option value="monospace">System Mono</option>
                            </select>
                        </div>
                        <div class="settings-row">
                            <label class="settings-label">B·∫≠t font ligatures</label>
                            <input type="checkbox" id="setting-editor-ligatures" onchange="updateSetting('editorLigatures', this.checked)" class="settings-checkbox">
                        </div>
                        <div class="settings-row flex-col items-start">
                            <label class="settings-label mb-2">T·ª± ƒë·ªông format SQL</label>
                            <div class="flex flex-wrap gap-3 text-sm">
                                <label class="flex items-center gap-1.5 cursor-pointer">
                                    <input type="radio" name="autoformat" value="off" onchange="updateSetting('autoFormatMode', 'off')"> T·∫Øt
                                </label>
                                <label class="flex items-center gap-1.5 cursor-pointer">
                                    <input type="radio" name="autoformat" value="run" onchange="updateSetting('autoFormatMode', 'run')"> Khi nh·∫•n RUN
                                </label>
                                <label class="flex items-center gap-1.5 cursor-pointer">
                                    <input type="radio" name="autoformat" value="paste" onchange="updateSetting('autoFormatMode', 'paste')"> Khi Paste
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3. AI & API -->
                <div class="settings-group">
                    <h4 class="settings-group-title"><span class="material-symbols-outlined text-sm">smart_toy</span> AI & API</h4>
                    <div class="settings-group-content">
                        <div class="settings-row flex-col items-start">
                            <label class="settings-label mb-1">Google Gemini API Key</label>
                            <input id="api-key-input" type="password" placeholder="AIzaSy..." class="w-full border border-slate-300 rounded px-3 py-2 font-mono text-sm focus:ring-2 focus:ring-indigo-300 focus:border-indigo-500">
                            <p class="text-xs text-slate-500 mt-1">L·∫•y API key mi·ªÖn ph√≠ t·∫°i <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-indigo-600 hover:underline">Google AI Studio</a></p>
                        </div>
                        <div class="settings-row">
                            <label class="settings-label">Model AI</label>
                            <select id="setting-ai-model" onchange="updateSetting('aiModel', this.value)" class="settings-select">
                                <option value="gemini_flash">Gemini Flash (Nhanh)</option>
                                <option value="gemini_pro">Gemini Pro (M·∫°nh)</option>
                                <option value="gemini_lite">Ti·∫øt ki·ªám</option>
                            </select>
                        </div>
                        <div class="settings-row">
                            <button onclick="testAIConnection()" class="bg-indigo-100 text-indigo-700 px-4 py-2 rounded text-sm font-bold hover:bg-indigo-200 transition flex items-center gap-2">
                                <span class="material-symbols-outlined text-sm">wifi_tethering</span> Ki·ªÉm tra k·∫øt n·ªëi AI
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 4. K·∫æT QU·∫¢ & HI·ªÜU NƒÇNG -->
                <div class="settings-group">
                    <h4 class="settings-group-title"><span class="material-symbols-outlined text-sm">speed</span> K·∫øt qu·∫£ & Hi·ªáu nƒÉng</h4>
                    <div class="settings-group-content">
                        <div class="settings-row flex-col items-start">
                            <label class="settings-label mb-2">Hi·ªÉn th·ªã k·∫øt qu·∫£ SQL</label>
                            <div class="flex flex-wrap gap-3 text-sm">
                                <label class="flex items-center gap-1.5 cursor-pointer">
                                    <input type="radio" name="resultview" value="table" onchange="updateSetting('resultView', 'table')"> B·∫£ng
                                </label>
                                <label class="flex items-center gap-1.5 cursor-pointer">
                                    <input type="radio" name="resultview" value="json" onchange="updateSetting('resultView', 'json')"> JSON
                                </label>
                                <label class="flex items-center gap-1.5 cursor-pointer">
                                    <input type="radio" name="resultview" value="auto" onchange="updateSetting('resultView', 'auto')"> T·ª± ƒë·ªông
                                </label>
                            </div>
                        </div>
                        <div class="settings-row">
                            <label class="settings-label">Ch·∫ø ƒë·ªô ERD</label>
                            <select id="setting-erd-mode" onchange="updateSetting('erdMode', this.value)" class="settings-select">
                                <option value="full">ƒê·∫ßy ƒë·ªß</option>
                                <option value="lite">Nh·∫π</option>
                                <option value="off">T·∫Øt</option>
                            </select>
                        </div>
                        <div class="settings-row">
                            <label class="settings-label">Ch·∫ø ƒë·ªô m√°y y·∫øu</label>
                            <input type="checkbox" id="setting-low-power" onchange="updateSetting('lowPowerMode', this.checked)" class="settings-checkbox">
                        </div>
                    </div>
                </div>

                <!-- 5. NG√îN NG·ªÆ & TRUY C·∫¨P -->
                <div class="settings-group">
                    <h4 class="settings-group-title"><span class="material-symbols-outlined text-sm">language</span> Ng√¥n ng·ªØ & Truy c·∫≠p</h4>
                    <div class="settings-group-content">
                        <div class="settings-row">
                            <label class="settings-label">Ng√¥n ng·ªØ</label>
                            <select id="setting-language" onchange="updateSetting('language', this.value)" class="settings-select">
                                <option value="vi">Ti·∫øng Vi·ªát</option>
                                <option value="en">English</option>
                            </select>
                        </div>
                        <p class="text-xs text-slate-400 italic -mt-2 mb-2 pl-1">(ƒêa ng√¥n ng·ªØ ƒëang ph√°t tri·ªÉn)</p>
                        <div class="settings-row">
                            <label class="settings-label">Ch·∫ø ƒë·ªô t∆∞∆°ng ph·∫£n cao</label>
                            <input type="checkbox" id="setting-high-contrast" onchange="updateSetting('highContrast', this.checked)" class="settings-checkbox">
                        </div>
                        <div class="settings-row">
                            <label class="settings-label">Ph√≥ng to giao di·ªán</label>
                            <input type="checkbox" id="setting-ui-scale" onchange="updateSetting('uiScale', this.checked ? 'large' : 'normal')" class="settings-checkbox">
                        </div>
                    </div>
                </div>

                <!-- 6. H·ªÜ TH·ªêNG & D·ªÆ LI·ªÜU -->
                <div class="settings-group">
                    <h4 class="settings-group-title"><span class="material-symbols-outlined text-sm">storage</span> H·ªá th·ªëng & D·ªØ li·ªáu</h4>
                    <div class="settings-group-content">
                        <div class="settings-row">
                            <label class="settings-label">T·ª± ƒë·ªông l∆∞u n·ªôi dung editor</label>
                            <input type="checkbox" id="setting-autosave" onchange="updateSetting('autosaveEnabled', this.checked)" class="settings-checkbox">
                        </div>
                        <div class="flex flex-wrap gap-3 pt-2">
                            <button onclick="resetSettings()" class="bg-amber-100 text-amber-700 px-4 py-2 rounded text-sm font-bold hover:bg-amber-200 transition flex items-center gap-2">
                                <span class="material-symbols-outlined text-sm">restart_alt</span> Kh√¥i ph·ª•c m·∫∑c ƒë·ªãnh
                            </button>
                            <button onclick="clearAllData()" class="bg-red-100 text-red-700 px-4 py-2 rounded text-sm font-bold hover:bg-red-200 transition flex items-center gap-2">
                                <span class="material-symbols-outlined text-sm">delete_forever</span> Xo√° to√†n b·ªô & ƒêƒÉng xu·∫•t
                            </button>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Footer -->
            <div class="sticky bottom-0 bg-slate-50 px-6 py-4 border-t border-slate-200 rounded-b-xl flex justify-end gap-3">
                <button onclick="closeSettings()" class="px-4 py-2 rounded text-sm font-bold text-slate-600 hover:bg-slate-200 transition">ƒê√≥ng</button>
                <button onclick="saveAllSettings()" class="bg-indigo-600 text-white px-6 py-2 rounded text-sm font-bold hover:bg-indigo-700 transition flex items-center gap-2">
                    <span class="material-symbols-outlined text-sm">save</span> L∆∞u c√†i ƒë·∫∑t
                </button>
            </div>
        </div>
    </div>

    <!-- AI EXERCISE MODAL -->
    <div id="ai-exercise-modal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-md p-6 relative">
            <button onclick="document.getElementById('ai-exercise-modal').classList.add('hidden')" class="absolute top-3 right-3 text-slate-400 hover:text-slate-600">
                <span class="material-symbols-outlined">close</span>
            </button>
            <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                <span class="material-symbols-outlined">auto_awesome</span> AI T·∫°o B√†i T·∫≠p M·ªõi
            </h3>
            <div class="space-y-4">
                <div>
                    <label class="text-sm font-bold text-slate-600 block mb-1">C·∫•p ƒë·ªô:</label>
                    <select id="ai-ex-level" class="w-full border border-slate-300 rounded px-4 py-2.5 focus:ring-2 focus:ring-indigo-300 focus:border-indigo-500">
                        <option value="Basic">C∆° b·∫£n</option>
                        <option value="Intermediate">Trung c·∫•p</option>
                        <option value="Advanced">N√¢ng cao</option>
                    </select>
                </div>
                <div>
                    <label class="text-sm font-bold text-slate-600 block mb-1">Ch·ªß ƒë·ªÅ (t√πy ch·ªçn):</label>
                    <input id="ai-ex-topic" type="text" placeholder="VD: JOIN, GROUP BY, Subquery..." class="w-full border border-slate-300 rounded px-4 py-2.5 focus:ring-2 focus:ring-indigo-300 focus:border-indigo-500">
                </div>
                <button onclick="submitAIExerciseGeneration()" class="w-full bg-indigo-600 text-white py-2.5 rounded font-bold hover:bg-indigo-700 transition">T·∫°o b√†i t·∫≠p</button>
            </div>
        </div>
    </div>

    <!-- TOAST -->
    <div id="toast" class="fixed top-4 left-1/2 -translate-x-1/2 bg-slate-800 text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300 translate-y-[-150%]">
        <span id="toast-msg">Th√¥ng b√°o</span>
    </div>

    <!-- External Script -->
    <script src="script.js" defer></script>
</body>
</html>
