/* Import Code Fonts */
@import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=JetBrains+Mono:wght@400;500&display=swap');

body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #334155; transition: background-color 0.3s, color 0.3s; }

/* ========================================
   THEME SYSTEM
   ======================================== */

/* Light Theme (Default) */
body, body.theme-light, body.theme-system {
    --bg-primary: #f8fafc;
    --bg-secondary: #ffffff;
    --bg-tertiary: #f1f5f9;
    --text-primary: #334155;
    --text-secondary: #64748b;
    --border-color: #e2e8f0;
    --accent: #4f46e5;
}

/* ========================================
   DARK THEME - Modern Dark Gray Palette
   ======================================== */

body.theme-dark,
body.theme-system[data-theme="dark"] {
    /* New Modern Dark Palette */
    --bg-primary: #020617;      /* slate-950 - deepest */
    --bg-secondary: #0f172a;    /* slate-900 - cards/panels */
    --bg-tertiary: #111827;     /* gray-900 - hover states */
    --bg-elevated: #1e293b;     /* slate-800 - elevated surfaces */
    --text-primary: #e5e7eb;    /* gray-200 - main text */
    --text-secondary: #9ca3af;  /* gray-400 - secondary text */
    --text-muted: #6b7280;      /* gray-500 - muted text */
    --border-color: #1f2937;    /* gray-800 - borders */
    --border-light: #374151;    /* gray-700 - lighter borders */
    --accent: #6366f1;          /* indigo-500 */
    --accent-dark: #4f46e5;     /* indigo-600 */
    --accent-light: #818cf8;    /* indigo-400 */
    --accent-bg: rgba(99, 102, 241, 0.18);
    --accent-bg-hover: rgba(99, 102, 241, 0.28);
    
    background-color: var(--bg-primary);
    color: var(--text-primary);
}

/* === SIDEBAR === */
body.theme-dark #sidebar,
body.theme-system[data-theme="dark"] #sidebar {
    background-color: var(--bg-primary);
    border-right: 1px solid var(--border-color);
}

/* Sidebar header area */
body.theme-dark #sidebar .bg-slate-50,
body.theme-system[data-theme="dark"] #sidebar .bg-slate-50 {
    background-color: var(--bg-secondary) !important;
}

/* === SIDEBAR NAV ITEMS === */
/* Normal state */
body.theme-dark #sidebar .nav-item,
body.theme-system[data-theme="dark"] #sidebar .nav-item {
    background: transparent;
    color: var(--text-primary);
}

/* Hover state - clear visible text */
body.theme-dark #sidebar .nav-item:hover,
body.theme-system[data-theme="dark"] #sidebar .nav-item:hover {
    background-color: var(--bg-tertiary);
    color: #f9fafb !important;
}

/* Active state - currently selected item */
body.theme-dark #sidebar .nav-item.active,
body.theme-dark #sidebar .nav-item.bg-indigo-50,
body.theme-dark #sidebar .nav-item[class*="text-indigo-700"],
body.theme-system[data-theme="dark"] #sidebar .nav-item.active,
body.theme-system[data-theme="dark"] #sidebar .nav-item.bg-indigo-50,
body.theme-system[data-theme="dark"] #sidebar .nav-item[class*="text-indigo-700"] {
    background-color: var(--accent-bg) !important;
    color: #e0e7ff !important;
    border-right: 3px solid var(--accent);
    font-weight: 600;
}

/* Hover on active item */
body.theme-dark #sidebar .nav-item.active:hover,
body.theme-dark #sidebar .nav-item.bg-indigo-50:hover,
body.theme-system[data-theme="dark"] #sidebar .nav-item.active:hover,
body.theme-system[data-theme="dark"] #sidebar .nav-item.bg-indigo-50:hover {
    background-color: var(--accent-bg-hover) !important;
    color: #f9fafb !important;
}

/* Fix text colors that might override */
body.theme-dark #sidebar .nav-item .text-slate-600,
body.theme-dark #sidebar .nav-item.text-slate-600,
body.theme-system[data-theme="dark"] #sidebar .nav-item .text-slate-600,
body.theme-system[data-theme="dark"] #sidebar .nav-item.text-slate-600 {
    color: var(--text-primary) !important;
}

/* === TAB BUTTONS (DDL/DML Sub-tabs) === */
/* Tab container background */
body.theme-dark .tab-buttons-container,
body.theme-system[data-theme="dark"] .tab-buttons-container {
    background-color: var(--bg-secondary) !important;
}

/* Normal tab buttons */
body.theme-dark .tab-buttons-container .tab-btn-ddl,
body.theme-dark .tab-buttons-container .tab-btn-dml,
body.theme-system[data-theme="dark"] .tab-buttons-container .tab-btn-ddl,
body.theme-system[data-theme="dark"] .tab-buttons-container .tab-btn-dml {
    background-color: var(--bg-primary);
    border: 1px solid var(--border-color);
    color: var(--text-primary);
}

/* Hover on inactive tabs */
body.theme-dark .tab-buttons-container .tab-btn-ddl:hover,
body.theme-dark .tab-buttons-container .tab-btn-dml:hover,
body.theme-system[data-theme="dark"] .tab-buttons-container .tab-btn-ddl:hover,
body.theme-system[data-theme="dark"] .tab-buttons-container .tab-btn-dml:hover {
    background-color: var(--bg-tertiary);
    color: #f9fafb;
}

/* Active tab - prominent with accent color */
body.theme-dark .tab-buttons-container .tab-btn-ddl.active,
body.theme-dark .tab-buttons-container .tab-btn-dml.active,
body.theme-dark .tab-btn-ddl.active,
body.theme-dark .tab-btn-dml.active,
body.theme-system[data-theme="dark"] .tab-buttons-container .tab-btn-ddl.active,
body.theme-system[data-theme="dark"] .tab-buttons-container .tab-btn-dml.active,
body.theme-system[data-theme="dark"] .tab-btn-ddl.active,
body.theme-system[data-theme="dark"] .tab-btn-dml.active {
    background-color: var(--accent-dark) !important;
    border-color: var(--accent) !important;
    color: #f9fafb !important;
    box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.3);
    font-weight: 600;
}

/* === GENERAL BACKGROUNDS & CARDS === */
body.theme-dark .bg-white,
body.theme-system[data-theme="dark"] .bg-white {
    background-color: var(--bg-secondary) !important;
}

body.theme-dark .bg-slate-50,
body.theme-system[data-theme="dark"] .bg-slate-50 {
    background-color: var(--bg-tertiary) !important;
}

body.theme-dark .bg-slate-100,
body.theme-system[data-theme="dark"] .bg-slate-100 {
    background-color: var(--bg-tertiary) !important;
}

body.theme-dark .bg-slate-200\/50,
body.theme-system[data-theme="dark"] .bg-slate-200\/50 {
    background-color: var(--bg-secondary) !important;
}

/* === TEXT COLORS - Comprehensive High Contrast for Dark Mode === */

/* Slate/Gray text - Main content */
body.theme-dark .text-slate-800,
body.theme-dark .text-slate-700,
body.theme-dark .text-slate-600,
body.theme-dark .text-gray-800,
body.theme-dark .text-gray-700,
body.theme-dark .text-gray-600,
body.theme-system[data-theme="dark"] .text-slate-800,
body.theme-system[data-theme="dark"] .text-slate-700,
body.theme-system[data-theme="dark"] .text-slate-600,
body.theme-system[data-theme="dark"] .text-gray-800,
body.theme-system[data-theme="dark"] .text-gray-700,
body.theme-system[data-theme="dark"] .text-gray-600 {
    color: #e5e7eb !important; /* gray-200 - high contrast */
}

body.theme-dark .text-slate-500,
body.theme-dark .text-slate-400,
body.theme-dark .text-gray-500,
body.theme-dark .text-gray-400,
body.theme-system[data-theme="dark"] .text-slate-500,
body.theme-system[data-theme="dark"] .text-slate-400,
body.theme-system[data-theme="dark"] .text-gray-500,
body.theme-system[data-theme="dark"] .text-gray-400 {
    color: #9ca3af !important; /* gray-400 */
}

/* Blue text - Info/Primary */
body.theme-dark .text-blue-800,
body.theme-dark .text-blue-700,
body.theme-dark .text-blue-600,
body.theme-dark .text-blue-500,
body.theme-system[data-theme="dark"] .text-blue-800,
body.theme-system[data-theme="dark"] .text-blue-700,
body.theme-system[data-theme="dark"] .text-blue-600,
body.theme-system[data-theme="dark"] .text-blue-500 {
    color: #93c5fd !important; /* blue-300 - bright on dark */
}

/* Green text - Success */
body.theme-dark .text-green-800,
body.theme-dark .text-green-700,
body.theme-dark .text-green-600,
body.theme-dark .text-green-500,
body.theme-system[data-theme="dark"] .text-green-800,
body.theme-system[data-theme="dark"] .text-green-700,
body.theme-system[data-theme="dark"] .text-green-600,
body.theme-system[data-theme="dark"] .text-green-500 {
    color: #86efac !important; /* green-300 */
}

/* Red text - Error/Danger */
body.theme-dark .text-red-800,
body.theme-dark .text-red-700,
body.theme-dark .text-red-600,
body.theme-dark .text-red-500,
body.theme-system[data-theme="dark"] .text-red-800,
body.theme-system[data-theme="dark"] .text-red-700,
body.theme-system[data-theme="dark"] .text-red-600,
body.theme-system[data-theme="dark"] .text-red-500 {
    color: #fca5a5 !important; /* red-300 */
}

/* Yellow text - Warning */
body.theme-dark .text-yellow-800,
body.theme-dark .text-yellow-700,
body.theme-dark .text-yellow-600,
body.theme-dark .text-yellow-500,
body.theme-system[data-theme="dark"] .text-yellow-800,
body.theme-system[data-theme="dark"] .text-yellow-700,
body.theme-system[data-theme="dark"] .text-yellow-600,
body.theme-system[data-theme="dark"] .text-yellow-500 {
    color: #fde047 !important; /* yellow-300 */
}

/* Amber/Orange text */
body.theme-dark .text-amber-800,
body.theme-dark .text-amber-700,
body.theme-dark .text-amber-600,
body.theme-dark .text-amber-500,
body.theme-dark .text-orange-800,
body.theme-dark .text-orange-700,
body.theme-dark .text-orange-600,
body.theme-dark .text-orange-500,
body.theme-system[data-theme="dark"] .text-amber-800,
body.theme-system[data-theme="dark"] .text-amber-700,
body.theme-system[data-theme="dark"] .text-amber-600,
body.theme-system[data-theme="dark"] .text-amber-500,
body.theme-system[data-theme="dark"] .text-orange-800,
body.theme-system[data-theme="dark"] .text-orange-700,
body.theme-system[data-theme="dark"] .text-orange-600,
body.theme-system[data-theme="dark"] .text-orange-500 {
    color: #fcd34d !important; /* amber-300 */
}

/* Pink/Rose text */
body.theme-dark .text-pink-800,
body.theme-dark .text-pink-700,
body.theme-dark .text-pink-600,
body.theme-dark .text-pink-500,
body.theme-dark .text-rose-800,
body.theme-dark .text-rose-700,
body.theme-dark .text-rose-600,
body.theme-dark .text-rose-500,
body.theme-system[data-theme="dark"] .text-pink-800,
body.theme-system[data-theme="dark"] .text-pink-700,
body.theme-system[data-theme="dark"] .text-pink-600,
body.theme-system[data-theme="dark"] .text-pink-500,
body.theme-system[data-theme="dark"] .text-rose-800,
body.theme-system[data-theme="dark"] .text-rose-700,
body.theme-system[data-theme="dark"] .text-rose-600,
body.theme-system[data-theme="dark"] .text-rose-500 {
    color: #f9a8d4 !important; /* pink-300 */
}

/* Purple text */
body.theme-dark .text-purple-800,
body.theme-dark .text-purple-700,
body.theme-dark .text-purple-600,
body.theme-dark .text-purple-500,
body.theme-dark .text-violet-800,
body.theme-dark .text-violet-700,
body.theme-dark .text-violet-600,
body.theme-dark .text-violet-500,
body.theme-system[data-theme="dark"] .text-purple-800,
body.theme-system[data-theme="dark"] .text-purple-700,
body.theme-system[data-theme="dark"] .text-purple-600,
body.theme-system[data-theme="dark"] .text-purple-500,
body.theme-system[data-theme="dark"] .text-violet-800,
body.theme-system[data-theme="dark"] .text-violet-700,
body.theme-system[data-theme="dark"] .text-violet-600,
body.theme-system[data-theme="dark"] .text-violet-500 {
    color: #d8b4fe !important; /* purple-300 */
}

/* Indigo text - Accent */
body.theme-dark .text-indigo-900,
body.theme-dark .text-indigo-800,
body.theme-dark .text-indigo-700,
body.theme-dark .text-indigo-600,
body.theme-dark .text-indigo-500,
body.theme-system[data-theme="dark"] .text-indigo-900,
body.theme-system[data-theme="dark"] .text-indigo-800,
body.theme-system[data-theme="dark"] .text-indigo-700,
body.theme-system[data-theme="dark"] .text-indigo-600,
body.theme-system[data-theme="dark"] .text-indigo-500 {
    color: #a5b4fc !important; /* indigo-300 */
}

/* Teal/Cyan text */
body.theme-dark .text-teal-800,
body.theme-dark .text-teal-700,
body.theme-dark .text-teal-600,
body.theme-dark .text-teal-500,
body.theme-dark .text-cyan-800,
body.theme-dark .text-cyan-700,
body.theme-dark .text-cyan-600,
body.theme-dark .text-cyan-500,
body.theme-system[data-theme="dark"] .text-teal-800,
body.theme-system[data-theme="dark"] .text-teal-700,
body.theme-system[data-theme="dark"] .text-teal-600,
body.theme-system[data-theme="dark"] .text-teal-500,
body.theme-system[data-theme="dark"] .text-cyan-800,
body.theme-system[data-theme="dark"] .text-cyan-700,
body.theme-system[data-theme="dark"] .text-cyan-600,
body.theme-system[data-theme="dark"] .text-cyan-500 {
    color: #5eead4 !important; /* teal-300 */
}

/* Emerald text */
body.theme-dark .text-emerald-800,
body.theme-dark .text-emerald-700,
body.theme-dark .text-emerald-600,
body.theme-dark .text-emerald-500,
body.theme-system[data-theme="dark"] .text-emerald-800,
body.theme-system[data-theme="dark"] .text-emerald-700,
body.theme-system[data-theme="dark"] .text-emerald-600,
body.theme-system[data-theme="dark"] .text-emerald-500 {
    color: #6ee7b7 !important; /* emerald-300 */
}

/* Lime text */
body.theme-dark .text-lime-800,
body.theme-dark .text-lime-700,
body.theme-dark .text-lime-600,
body.theme-dark .text-lime-500,
body.theme-system[data-theme="dark"] .text-lime-800,
body.theme-system[data-theme="dark"] .text-lime-700,
body.theme-system[data-theme="dark"] .text-lime-600,
body.theme-system[data-theme="dark"] .text-lime-500 {
    color: #bef264 !important; /* lime-300 */
}

/* Sky text */
body.theme-dark .text-sky-800,
body.theme-dark .text-sky-700,
body.theme-dark .text-sky-600,
body.theme-dark .text-sky-500,
body.theme-system[data-theme="dark"] .text-sky-800,
body.theme-system[data-theme="dark"] .text-sky-700,
body.theme-system[data-theme="dark"] .text-sky-600,
body.theme-system[data-theme="dark"] .text-sky-500 {
    color: #7dd3fc !important; /* sky-300 */
}

/* Fuchsia text */
body.theme-dark .text-fuchsia-800,
body.theme-dark .text-fuchsia-700,
body.theme-dark .text-fuchsia-600,
body.theme-dark .text-fuchsia-500,
body.theme-system[data-theme="dark"] .text-fuchsia-800,
body.theme-system[data-theme="dark"] .text-fuchsia-700,
body.theme-system[data-theme="dark"] .text-fuchsia-600,
body.theme-system[data-theme="dark"] .text-fuchsia-500 {
    color: #f0abfc !important; /* fuchsia-300 */
}

/* === SPECIAL CONTENT BLOCKS - High Contrast Text === */

/* Info boxes with colored backgrounds */
body.theme-dark .bg-blue-50 *,
body.theme-dark .bg-green-50 *,
body.theme-dark .bg-yellow-50 *,
body.theme-dark .bg-red-50 *,
body.theme-dark .bg-amber-50 *,
body.theme-dark .bg-orange-50 *,
body.theme-dark .bg-pink-50 *,
body.theme-dark .bg-rose-50 *,
body.theme-dark .bg-purple-50 *,
body.theme-dark .bg-indigo-50 *,
body.theme-dark .bg-teal-50 *,
body.theme-dark .bg-cyan-50 *,
body.theme-system[data-theme="dark"] .bg-blue-50 *,
body.theme-system[data-theme="dark"] .bg-green-50 *,
body.theme-system[data-theme="dark"] .bg-yellow-50 *,
body.theme-system[data-theme="dark"] .bg-red-50 *,
body.theme-system[data-theme="dark"] .bg-amber-50 *,
body.theme-system[data-theme="dark"] .bg-orange-50 *,
body.theme-system[data-theme="dark"] .bg-pink-50 *,
body.theme-system[data-theme="dark"] .bg-rose-50 *,
body.theme-system[data-theme="dark"] .bg-purple-50 *,
body.theme-system[data-theme="dark"] .bg-indigo-50 *,
body.theme-system[data-theme="dark"] .bg-teal-50 *,
body.theme-system[data-theme="dark"] .bg-cyan-50 * {
    color: #e5e7eb !important;
}

/* More specific text colors inside info boxes */
body.theme-dark .bg-blue-50 .text-blue-800,
body.theme-dark .bg-blue-50 .text-blue-700,
body.theme-system[data-theme="dark"] .bg-blue-50 .text-blue-800,
body.theme-system[data-theme="dark"] .bg-blue-50 .text-blue-700 {
    color: #93c5fd !important;
}

body.theme-dark .bg-green-50 .text-green-800,
body.theme-dark .bg-green-50 .text-green-700,
body.theme-system[data-theme="dark"] .bg-green-50 .text-green-800,
body.theme-system[data-theme="dark"] .bg-green-50 .text-green-700 {
    color: #86efac !important;
}

body.theme-dark .bg-yellow-50 .text-yellow-800,
body.theme-dark .bg-yellow-50 .text-yellow-700,
body.theme-dark .bg-amber-50 .text-amber-800,
body.theme-dark .bg-amber-50 .text-amber-700,
body.theme-system[data-theme="dark"] .bg-yellow-50 .text-yellow-800,
body.theme-system[data-theme="dark"] .bg-yellow-50 .text-yellow-700,
body.theme-system[data-theme="dark"] .bg-amber-50 .text-amber-800,
body.theme-system[data-theme="dark"] .bg-amber-50 .text-amber-700 {
    color: #fde047 !important;
}

body.theme-dark .bg-red-50 .text-red-800,
body.theme-dark .bg-red-50 .text-red-700,
body.theme-system[data-theme="dark"] .bg-red-50 .text-red-800,
body.theme-system[data-theme="dark"] .bg-red-50 .text-red-700 {
    color: #fca5a5 !important;
}

body.theme-dark .bg-pink-50 .text-pink-800,
body.theme-dark .bg-pink-50 .text-pink-700,
body.theme-dark .bg-rose-50 .text-rose-800,
body.theme-dark .bg-rose-50 .text-rose-700,
body.theme-system[data-theme="dark"] .bg-pink-50 .text-pink-800,
body.theme-system[data-theme="dark"] .bg-pink-50 .text-pink-700,
body.theme-system[data-theme="dark"] .bg-rose-50 .text-rose-800,
body.theme-system[data-theme="dark"] .bg-rose-50 .text-rose-700 {
    color: #f9a8d4 !important;
}

body.theme-dark .bg-purple-50 .text-purple-800,
body.theme-dark .bg-purple-50 .text-purple-700,
body.theme-system[data-theme="dark"] .bg-purple-50 .text-purple-800,
body.theme-system[data-theme="dark"] .bg-purple-50 .text-purple-700 {
    color: #d8b4fe !important;
}

body.theme-dark .bg-indigo-50 .text-indigo-900,
body.theme-dark .bg-indigo-50 .text-indigo-800,
body.theme-dark .bg-indigo-50 .text-indigo-700,
body.theme-system[data-theme="dark"] .bg-indigo-50 .text-indigo-900,
body.theme-system[data-theme="dark"] .bg-indigo-50 .text-indigo-800,
body.theme-system[data-theme="dark"] .bg-indigo-50 .text-indigo-700 {
    color: #c7d2fe !important; /* indigo-200 for better contrast */
}

body.theme-dark .bg-teal-50 .text-teal-800,
body.theme-dark .bg-teal-50 .text-teal-700,
body.theme-system[data-theme="dark"] .bg-teal-50 .text-teal-800,
body.theme-system[data-theme="dark"] .bg-teal-50 .text-teal-700 {
    color: #5eead4 !important;
}

/* === Italic/Note text - ensure visibility === */
body.theme-dark .italic,
body.theme-dark [class*="italic"],
body.theme-system[data-theme="dark"] .italic,
body.theme-system[data-theme="dark"] [class*="italic"] {
    color: #d1d5db !important; /* gray-300 */
}

/* === code tags inside text === */
body.theme-dark code:not(.code-block *),
body.theme-system[data-theme="dark"] code:not(.code-block *) {
    background-color: #1e293b;
    color: #f472b6; /* pink-400 for code */
    padding: 2px 6px;
    border-radius: 4px;
}

/* === Bold/Strong text - slightly brighter === */
body.theme-dark b,
body.theme-dark strong,
body.theme-system[data-theme="dark"] b,
body.theme-system[data-theme="dark"] strong {
    color: #f3f4f6 !important; /* gray-100 */
}

/* Special case: bold with color class */
body.theme-dark b.text-red-500,
body.theme-dark strong.text-red-500,
body.theme-system[data-theme="dark"] b.text-red-500,
body.theme-system[data-theme="dark"] strong.text-red-500 {
    color: #fca5a5 !important;
}

/* === Paragraph and list items === */
body.theme-dark p,
body.theme-dark li,
body.theme-system[data-theme="dark"] p,
body.theme-system[data-theme="dark"] li {
    color: #e5e7eb;
}

/* === Links === */
body.theme-dark a:not([class*="bg-"]),
body.theme-system[data-theme="dark"] a:not([class*="bg-"]) {
    color: #818cf8; /* indigo-400 */
}

body.theme-dark a:hover,
body.theme-system[data-theme="dark"] a:hover {
    color: #a5b4fc; /* indigo-300 */
}

/* === BORDERS === */
body.theme-dark .border-slate-200,
body.theme-dark .border-slate-100,
body.theme-dark .border-slate-300,
body.theme-system[data-theme="dark"] .border-slate-200,
body.theme-system[data-theme="dark"] .border-slate-100,
body.theme-system[data-theme="dark"] .border-slate-300 {
    border-color: var(--border-color) !important;
}

/* === FORM INPUTS === */
body.theme-dark input,
body.theme-dark textarea,
body.theme-dark select,
body.theme-system[data-theme="dark"] input,
body.theme-system[data-theme="dark"] textarea,
body.theme-system[data-theme="dark"] select {
    background-color: var(--bg-tertiary);
    color: var(--text-primary);
    border-color: var(--border-color);
}

body.theme-dark input::placeholder,
body.theme-dark textarea::placeholder,
body.theme-system[data-theme="dark"] input::placeholder,
body.theme-system[data-theme="dark"] textarea::placeholder {
    color: var(--text-muted);
}

body.theme-dark input:focus,
body.theme-dark textarea:focus,
body.theme-dark select:focus,
body.theme-system[data-theme="dark"] input:focus,
body.theme-system[data-theme="dark"] textarea:focus,
body.theme-system[data-theme="dark"] select:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 2px var(--accent-bg);
}

/* === CODE BLOCKS === */
body.theme-dark .code-block,
body.theme-system[data-theme="dark"] .code-block {
    background-color: var(--bg-primary);
    border: 1px solid var(--border-color);
    color: #e5e7eb;
}

/* === AI EXPLANATION BOX === */
body.theme-dark .ai-explanation-box,
body.theme-system[data-theme="dark"] .ai-explanation-box {
    background-color: #022c22;
    border-color: #16a34a;
    color: #bbf7d0;
}

/* === SQL RESULT TABLE === */
body.theme-dark .sql-result-table th,
body.theme-system[data-theme="dark"] .sql-result-table th {
    background-color: var(--bg-tertiary);
    border-color: var(--border-color);
    color: var(--text-primary);
}

body.theme-dark .sql-result-table td,
body.theme-system[data-theme="dark"] .sql-result-table td {
    border-color: var(--border-color);
    color: var(--text-primary);
}

body.theme-dark .sql-result-table tr:nth-child(even),
body.theme-system[data-theme="dark"] .sql-result-table tr:nth-child(even) {
    background-color: var(--bg-secondary);
}

body.theme-dark .sql-result-table tr:hover,
body.theme-system[data-theme="dark"] .sql-result-table tr:hover {
    background-color: var(--bg-tertiary);
}

/* === EXERCISE CARDS === */
body.theme-dark .exercise-card:hover,
body.theme-system[data-theme="dark"] .exercise-card:hover {
    background-color: var(--bg-tertiary);
}

body.theme-dark .exercise-card.active,
body.theme-system[data-theme="dark"] .exercise-card.active {
    background-color: var(--accent-bg);
    border-left-color: var(--accent);
}

/* === VISUALIZATIONS === */
body.theme-dark .table-visual,
body.theme-system[data-theme="dark"] .table-visual {
    background-color: var(--bg-secondary);
    border-color: var(--border-color);
}

body.theme-dark .table-header,
body.theme-system[data-theme="dark"] .table-header {
    background-color: var(--bg-tertiary);
    border-color: var(--border-color);
    color: var(--text-primary);
}

body.theme-dark .table-row,
body.theme-system[data-theme="dark"] .table-row {
    border-color: var(--border-color);
    color: var(--text-primary);
}

body.theme-dark .flow-node,
body.theme-system[data-theme="dark"] .flow-node {
    background-color: var(--bg-secondary);
    border-color: var(--border-color);
    color: var(--text-primary);
}

body.theme-dark .erd-table,
body.theme-system[data-theme="dark"] .erd-table {
    background-color: var(--bg-secondary);
    border-color: var(--border-color);
}

body.theme-dark #erd-canvas,
body.theme-system[data-theme="dark"] #erd-canvas {
    background-image: radial-gradient(var(--border-color) 1px, transparent 1px);
}

/* === VENN DIAGRAM === */
body.theme-dark .venn-circle,
body.theme-system[data-theme="dark"] .venn-circle {
    mix-blend-mode: screen;
}

/* === SCROLLBARS === */
body.theme-dark .custom-scroll::-webkit-scrollbar-track,
body.theme-system[data-theme="dark"] .custom-scroll::-webkit-scrollbar-track {
    background: var(--bg-secondary);
}

body.theme-dark .custom-scroll::-webkit-scrollbar-thumb,
body.theme-system[data-theme="dark"] .custom-scroll::-webkit-scrollbar-thumb {
    background: var(--border-light);
}

body.theme-dark .custom-scroll::-webkit-scrollbar-thumb:hover,
body.theme-system[data-theme="dark"] .custom-scroll::-webkit-scrollbar-thumb:hover {
    background: #4b5563;
}

/* === BUTTONS === */
body.theme-dark .bg-indigo-600,
body.theme-system[data-theme="dark"] .bg-indigo-600 {
    background-color: var(--accent-dark) !important;
}

body.theme-dark .bg-indigo-600:hover,
body.theme-system[data-theme="dark"] .bg-indigo-600:hover {
    background-color: var(--accent) !important;
}

body.theme-dark .hover\:bg-slate-50:hover,
body.theme-system[data-theme="dark"] .hover\:bg-slate-50:hover {
    background-color: var(--bg-tertiary) !important;
}

body.theme-dark .hover\:bg-slate-100:hover,
body.theme-system[data-theme="dark"] .hover\:bg-slate-100:hover {
    background-color: var(--bg-tertiary) !important;
}

/* === COLORED BACKGROUNDS (Blue, Green, Yellow, etc.) === */
body.theme-dark .bg-blue-50,
body.theme-dark .bg-green-50,
body.theme-dark .bg-yellow-50,
body.theme-dark .bg-red-50,
body.theme-dark .bg-purple-50,
body.theme-dark .bg-amber-50,
body.theme-dark .bg-indigo-50,
body.theme-dark .bg-teal-50,
body.theme-dark .bg-pink-50,
body.theme-system[data-theme="dark"] .bg-blue-50,
body.theme-system[data-theme="dark"] .bg-green-50,
body.theme-system[data-theme="dark"] .bg-yellow-50,
body.theme-system[data-theme="dark"] .bg-red-50,
body.theme-system[data-theme="dark"] .bg-purple-50,
body.theme-system[data-theme="dark"] .bg-amber-50,
body.theme-system[data-theme="dark"] .bg-indigo-50,
body.theme-system[data-theme="dark"] .bg-teal-50,
body.theme-system[data-theme="dark"] .bg-pink-50 {
    background-color: var(--bg-secondary) !important;
}

/* Colored borders in dark mode */
body.theme-dark .border-blue-200,
body.theme-dark .border-green-200,
body.theme-dark .border-yellow-200,
body.theme-dark .border-red-200,
body.theme-dark .border-indigo-200,
body.theme-dark .border-indigo-100,
body.theme-system[data-theme="dark"] .border-blue-200,
body.theme-system[data-theme="dark"] .border-green-200,
body.theme-system[data-theme="dark"] .border-yellow-200,
body.theme-system[data-theme="dark"] .border-red-200,
body.theme-system[data-theme="dark"] .border-indigo-200,
body.theme-system[data-theme="dark"] .border-indigo-100 {
    border-color: var(--border-light) !important;
}

/* === MODAL BACKGROUNDS === */
body.theme-dark #settings-modal > div > div,
body.theme-dark #auth-modal > div,
body.theme-dark #ai-exercise-modal > div > div,
body.theme-system[data-theme="dark"] #settings-modal > div > div,
body.theme-system[data-theme="dark"] #auth-modal > div,
body.theme-system[data-theme="dark"] #ai-exercise-modal > div > div {
    background-color: var(--bg-secondary);
}

/* === TOAST === */
body.theme-dark #toast,
body.theme-system[data-theme="dark"] #toast {
    background-color: var(--bg-elevated);
    color: var(--text-primary);
}

/* ========================================
   ACCESSIBILITY & EFFECTS
   ======================================== */

/* Disable effects */
body.effects-off * {
    animation: none !important;
    transition: none !important;
    box-shadow: none !important;
}

/* Low Power Mode */
body.low-power * {
    animation: none !important;
    transition-duration: 0s !important;
}

body.low-power .animate-fade-in {
    animation: none !important;
}

body.low-power .venn-circle {
    mix-blend-mode: normal;
}

/* High Contrast Mode */
body.high-contrast {
    --text-primary: #000000;
    --text-secondary: #1a1a1a;
    --border-color: #000000;
}

body.high-contrast .text-slate-500,
body.high-contrast .text-slate-400 {
    color: #333333 !important;
}

body.high-contrast .border-slate-200 {
    border-color: #000000 !important;
    border-width: 2px !important;
}

body.high-contrast button {
    border: 2px solid currentColor !important;
}

/* UI Scale Large */
body.ui-large {
    font-size: 18px;
}

body.ui-large .text-xs { font-size: 0.875rem; }
body.ui-large .text-sm { font-size: 1rem; }
body.ui-large .text-lg { font-size: 1.25rem; }
body.ui-large .text-xl { font-size: 1.5rem; }
body.ui-large .text-2xl { font-size: 1.75rem; }

/* ========================================
   SETTINGS MODAL STYLES
   ======================================== */

.settings-group {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    overflow: hidden;
}

body.theme-dark .settings-group,
body.theme-system[data-theme="dark"] .settings-group {
    background: var(--bg-secondary);
    border-color: var(--border-color);
}

.settings-group-title {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 16px;
    background: linear-gradient(to right, #eef2ff, #f8fafc);
    border-bottom: 1px solid #e2e8f0;
    font-weight: 700;
    font-size: 0.875rem;
    color: #4338ca;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

body.theme-dark .settings-group-title,
body.theme-system[data-theme="dark"] .settings-group-title {
    background: linear-gradient(to right, rgba(99, 102, 241, 0.15), var(--bg-secondary));
    border-color: var(--border-color);
    color: var(--accent-light);
}

.settings-group-content {
    padding: 16px;
    background: white;
}

body.theme-dark .settings-group-content,
body.theme-system[data-theme="dark"] .settings-group-content {
    background: var(--bg-tertiary);
}

.settings-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px solid #f1f5f9;
}

.settings-row:last-child {
    border-bottom: none;
}

body.theme-dark .settings-row,
body.theme-system[data-theme="dark"] .settings-row {
    border-color: var(--border-color);
}

.settings-label {
    font-size: 0.875rem;
    font-weight: 500;
    color: #475569;
}

body.theme-dark .settings-label,
body.theme-system[data-theme="dark"] .settings-label {
    color: var(--text-primary);
}

.settings-select {
    padding: 6px 12px;
    border: 1px solid #d1d5db;
    border-radius: 6px;
    font-size: 0.875rem;
    background: white;
    color: #374151;
    min-width: 140px;
    cursor: pointer;
}

.settings-select:focus {
    outline: none;
    box-shadow: 0 0 0 2px #6366f1;
    border-color: #6366f1;
}

body.theme-dark .settings-select,
body.theme-system[data-theme="dark"] .settings-select {
    background: var(--bg-secondary);
    color: var(--text-primary);
    border-color: var(--border-color);
}

body.theme-dark .settings-select:focus,
body.theme-system[data-theme="dark"] .settings-select:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 2px var(--accent-bg);
}

.settings-checkbox {
    width: 20px;
    height: 20px;
    accent-color: #4f46e5;
    cursor: pointer;
}

body.theme-dark .settings-checkbox,
body.theme-system[data-theme="dark"] .settings-checkbox {
    accent-color: var(--accent);
}

/* Custom Scrollbars */
.custom-scroll::-webkit-scrollbar { width: 6px; height: 6px; }
.custom-scroll::-webkit-scrollbar-track { background: #f1f5f9; }
.custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
.custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

/* Code Theme */
.code-block { 
  background-color: #1e1e1e; 
  color: #d4d4d4; 
  font-family: 'Consolas', 'Monaco', monospace; 
  line-height: 1.6; 
  font-size: 13px; 
}
.sql-kw { color: #569cd6; font-weight: bold; } 
.sql-str { color: #ce9178; } 
.sql-fn { color: #dcdcaa; } 
.sql-com { color: #6a9955; font-style: italic; } 

/* Visualizations & ERD */
.table-visual { border: 1px solid #cbd5e1; border-radius: 6px; background: white; overflow: hidden; min-width: 120px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
.table-header { background: #f1f5f9; padding: 6px; font-weight: 700; text-align: center; border-bottom: 1px solid #cbd5e1; font-size: 11px; color: #475569; text-transform: uppercase; letter-spacing: 0.5px; }
.table-row { padding: 5px 8px; font-size: 11px; border-bottom: 1px solid #f1f5f9; display: flex; justify-content: space-between; align-items: center; }
.pk-badge { background: #fef08a; color: #854d0e; padding: 1px 4px; border-radius: 3px; font-size: 9px; font-weight: bold; }

.venn-container { position: relative; width: 180px; height: 120px; margin: 0 auto; }
.venn-circle { position: absolute; width: 90px; height: 90px; border-radius: 50%; opacity: 0.6; mix-blend-mode: multiply; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; font-size: 12px; transition: transform 0.3s; }
.venn-a { background: #6366f1; left: 20px; top: 15px; } 
.venn-b { background: #ec4899; right: 20px; top: 15px; } 

.flow-node { border: 1px solid #e2e8f0; border-radius: 6px; padding: 8px 12px; background: white; font-size: 11px; font-weight: 600; text-align: center; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }

.erd-table { position: absolute; z-index: 10; width: 180px; background: white; border: 1px solid #cbd5e1; border-radius: 8px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); transition: transform 0.2s; }
.erd-table:hover { transform: scale(1.05); z-index: 20; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
#erd-canvas { position: relative; overflow: hidden; background-image: radial-gradient(#e5e7eb 1px, transparent 1px); background-size: 20px 20px; }

/* Exercises & Theory */
.exercise-card { transition: all 0.2s; cursor: pointer; border-left: 4px solid transparent; }
.exercise-card:hover { transform: translateX(4px); background-color: #f8fafc; }
.exercise-card.active { border-left-color: #4f46e5; background-color: #eff6ff; }
.exercise-card.completed .status-icon { color: #10b981; }

.exercise-group-header { font-size: 0.7rem; font-weight: 800; text-transform: uppercase; letter-spacing: 0.05em; color: #94a3b8; margin-top: 1rem; margin-bottom: 0.5rem; padding-left: 0.5rem; }

/* UI Elements */
.nav-item.active { background-color: #eff6ff; color: #4f46e5; border-right: 3px solid #4f46e5; font-weight: 600; }
.tab-btn-ddl.active, .tab-btn-dml.active { background-color: white; color: #4338ca; box-shadow: 0 1px 3px rgba(0,0,0,0.1); font-weight: 600; border: 1px solid #e2e8f0; }
.ai-explanation-box { display: none; margin-top: 12px; padding: 16px; background-color: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; font-size: 0.9rem; color: #166534; line-height: 1.6; }
.concept-note { font-size: 0.85rem; color: #64748b; line-height: 1.5; margin-bottom: 8px; }

/* Loading Animation */
.loading-dots::after {
    content: '';
    animation: dots 1.5s steps(4, end) infinite;
}
@keyframes dots {
    0%, 20% { content: ''; }
    40% { content: '.'; }
    60% { content: '..'; }
    80%, 100% { content: '...'; }
}

/* Fade-in Animation */
.animate-fade-in {
    animation: fadeIn 0.3s ease-in-out;
}
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* SQL Result Table */
.sql-result-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
.sql-result-table th { background-color: #f1f5f9; text-align: left; padding: 8px; border: 1px solid #e2e8f0; font-weight: 600; color: #475569; position: sticky; top: 0; white-space: nowrap; }
.sql-result-table td { padding: 8px; border: 1px solid #e2e8f0; color: #334155; }
.sql-result-table tr:nth-child(even) { background-color: #f8fafc; }
.sql-result-table tr:hover { background-color: #f0f9ff; }

/* Print optimization */
@media print {
    #sidebar, .no-print, #ai-fab, #toast, .ai-btn, #chat-modal, #auth-modal, #settings-modal, #ai-exercise-modal, .tab-buttons-container { display: none !important; }
    #main-content { margin: 0 !important; width: 100% !important; overflow: visible !important; padding: 0 !important; }
    
    /* Force all content sections to show (creating a full book) EXCEPT #demo */
    .content-section { 
        display: block !important; 
        opacity: 1 !important;
        visibility: visible !important;
        height: auto !important;
    }

    /* Except #demo must stay hidden */
    section#demo.content-section { display: none !important; }

    /* Formatting for print */
    .content-section { page-break-after: always; margin-bottom: 2cm; padding-bottom: 20px; border-bottom: 1px solid #eee; }
    .content-section:last-child { page-break-after: auto; border-bottom: none; }
    
    /* Fix Page Breaks: Keep Headings with Content */
    h1, h2, h3, h4 {
        page-break-after: avoid !important;
        break-after: avoid !important;
        orphans: 4 !important;
        widows: 4 !important;
    }
    h5, h6 {
        page-break-after: avoid;
        break-after: avoid;
    }

    /* Đảm bảo heading và nội dung liền sau luôn ở cùng 1 trang PDF */
    h1, h2, h3, h4 {
        break-inside: avoid !important;
        page-break-inside: avoid !important;
    }
    h1 + *, h2 + *, h3 + *, h4 + * {
        break-before: avoid-page !important;
        page-break-before: avoid !important;
        break-inside: avoid !important;
        page-break-inside: avoid !important;
    }

    /* Luôn tránh tách đoạn bên trong các block lớn và thành phần nội dung */
    p, ul, ol, table, pre, code, blockquote, img,
    .code-block, .table-visual, .venn-container, .flow-node, .grid, .exercise-card, .sql-result-table,
    .content-section, .content-block, .section-block, section {
        break-inside: avoid !important;
        page-break-inside: avoid !important;
    }

    /* Cố giữ heading và ít nhất 1-2 đoạn, bảng, hình ở cùng trang (nếu trình duyệt hỗ trợ) */
    h1 + p, h1 + ul, h1 + ol, h1 + table, h1 + pre, h1 + code, h1 + blockquote, h1 + img,
    h2 + p, h2 + ul, h2 + ol, h2 + table, h2 + pre, h2 + code, h2 + blockquote, h2 + img,
    h3 + p, h3 + ul, h3 + ol, h3 + table, h3 + pre, h3 + code, h3 + blockquote, h3 + img,
    h4 + p, h4 + ul, h4 + ol, h4 + table, h4 + pre, h4 + code, h4 + blockquote, h4 + img {
        break-inside: avoid !important;
        page-break-inside: avoid !important;
    }

    /* Nếu đoạn đầu sau heading là block lớn, vẫn không bị ngắt trang (ví dụ nhiều block liên tiếp sau heading) */
    h1 + .content-block, h2 + .content-block, h3 + .content-block, h4 + .content-block,
    h1 + .section-block, h2 + .section-block, h3 + .section-block, h4 + .section-block {
        break-inside: avoid !important;
        page-break-inside: avoid !important;
    }

    * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
    .code-block { border: 1px solid #ccc !important; background-color: #f3f4f6 !important; color: #111 !important; }

    /* Ensure Sub-tabs content are visible */
    .ddl-content, .dml-content { display: block !important; }

    /* Titles for sections */
    .ddl-content::before, .dml-content::before {
        content: attr(id); 
        display: block;
        font-weight: bold;
        font-size: 1.2em;
        margin-top: 2em;
        margin-bottom: 0.5em;
        text-transform: uppercase;
        color: #4338ca;
        border-bottom: 2px solid #e5e7eb;
        page-break-after: avoid; /* Keep title with content */
    }

    /* Exercises Section Special Handling for Print */
    #exercises-section .grid { display: none !important; } /* Hide interactive grid */
    #printable-exercises { display: block !important; } /* Show static list with answers */
    
    .lg\:col-span-3, .lg\:col-span-4 { width: 100% !important; }
}